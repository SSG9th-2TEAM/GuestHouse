import{_ as F,r as c,b as Q,x as ee,q as X,c as r,d as m,e,l as V,t as d,z as j,A as te,F as T,f as B,n as se,o,s as le,y as ne,m as U,C as L,E as ae,I as W,H as oe,k as ie}from"./index-D-t2vnuJ.js";import{A as re}from"./AdminStatCard-BRXY_H91.js";import{A as H}from"./AdminBadge-DlcxCZoH.js";import{A as de}from"./AdminTableCard-CiQvKoMq.js";import{z as ue,A as ce,B as ve}from"./adminApi-DEH9EAim.js";import{e as pe,a as me}from"./reportExport-BKny35g8.js";import{e as ye,a as be,t as z}from"./adminData-ZmZ3C3cR.js";const ge={class:"modal-content"},fe={class:"modal-header"},_e={class:"header-main"},we={class:"modal-title"},ke={key:0,class:"modal-body loading"},he={key:1,class:"modal-body error"},Ie={key:2,class:"modal-body split-layout"},De={class:"left-panel"},$e={class:"detail-section"},Ce={class:"info-list"},Ee={class:"info-row"},xe={class:"reason-text"},Ae={class:"info-row"},Re={class:"info-row"},Se={class:"type-badge"},Oe={class:"detail-section"},Te={class:"info-list"},Ne={class:"info-row"},Pe={class:"info-row"},Me={class:"info-row"},Le={class:"detail-section"},Ve={class:"description-text"},Be={class:"right-panel"},qe={key:0,class:"evidence-box"},Ge={class:"evidence-header"},Ue={class:"evidence-label"},We={class:"evidence-author"},ze={class:"review-rating"},Fe={class:"review-text"},Qe={key:0,class:"review-images"},Xe=["src"],je={key:1,class:"evidence-box"},He={key:2,class:"evidence-box"},Ke={key:3,class:"modal-footer"},Ye={class:"footer-left"},Je={class:"footer-right"},Ze={key:1,class:"status-text"},et={__name:"AdminReportDetailModal",props:{reportId:{type:[Number,String],required:!0},isOpen:{type:Boolean,default:!1}},emits:["close","action"],setup(A,{emit:R}){const y=A,b=R,n=c(null),v=c(!1),u=c(null),w=c(!1),h=i=>{i.key==="Escape"&&y.isOpen&&b("close")},S=async()=>{if(y.reportId){v.value=!0,u.value=null;try{const i=await ue(y.reportId);i.ok&&i.data?n.value=i.data:u.value="ì‹ ê³  ìƒì„¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤."}catch{u.value="ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."}finally{v.value=!1}}};Q(()=>{y.isOpen&&(S(),window.addEventListener("keydown",h),document.body.style.overflow="hidden")}),ee(()=>{window.removeEventListener("keydown",h),document.body.style.overflow=""});const E=i=>i?i.replace("T"," ").slice(0,16):"-",I=i=>i==="PROCESSED"||i==="BLIND"?"success":i==="IGNORED"?"neutral":"warning",D=i=>i==="PROCESSED"||i==="BLIND"?"ì²˜ë¦¬ì™„ë£Œ":i==="IGNORED"?"ë°˜ë ¤ë¨":"ëŒ€ê¸°ì¤‘",x=X(()=>n.value?.status==="PENDING"||n.value?.status==="WAIT"),$=i=>{b("action",i,n.value)},f=()=>{w.value=!w.value};return(i,s)=>A.isOpen?(o(),r("div",{key:0,class:"modal-overlay",onClick:s[5]||(s[5]=se(g=>i.$emit("close"),["self"]))},[e("div",ge,[e("header",fe,[e("div",_e,[e("h2",we,"ì‹ ê³  ìƒì„¸ #"+d(A.reportId),1),n.value?(o(),V(H,{key:0,text:D(n.value.status),variant:I(n.value.status)},null,8,["text","variant"])):m("",!0)]),e("button",{class:"close-btn",onClick:s[0]||(s[0]=g=>i.$emit("close"))},[...s[6]||(s[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),v.value?(o(),r("div",ke,[...s[7]||(s[7]=[e("div",{class:"spinner"},null,-1),e("p",null,"ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...",-1)])])):u.value?(o(),r("div",he,[e("p",null,d(u.value),1),e("button",{class:"retry-btn",onClick:S},"ë‹¤ì‹œ ì‹œë„")])):n.value?(o(),r("div",Ie,[e("div",De,[e("section",$e,[s[11]||(s[11]=e("h3",{class:"section-title"},"ì‹ ê³  ê°œìš”",-1)),e("dl",Ce,[e("div",Ee,[s[8]||(s[8]=e("dt",null,"ì‹ ê³  ì‚¬ìœ ",-1)),e("dd",xe,d(n.value.reason),1)]),e("div",Ae,[s[9]||(s[9]=e("dt",null,"ì ‘ìˆ˜ ì¼ì‹œ",-1)),e("dd",null,d(E(n.value.createdAt)),1)]),e("div",Re,[s[10]||(s[10]=e("dt",null,"ëŒ€ìƒ ìœ í˜•",-1)),e("dd",null,[e("span",Se,d(n.value.targetType),1)])])])]),e("section",Oe,[s[15]||(s[15]=e("h3",{class:"section-title"},"ì‹ ê³ ì ì •ë³´",-1)),e("dl",Te,[e("div",Ne,[s[12]||(s[12]=e("dt",null,"ë‹‰ë„¤ì„",-1)),e("dd",null,d(n.value.reporter?.nickname),1)]),e("div",Pe,[s[13]||(s[13]=e("dt",null,"ì´ë©”ì¼",-1)),e("dd",null,d(n.value.reporter?.email),1)]),e("div",Me,[s[14]||(s[14]=e("dt",null,"ID",-1)),e("dd",null,"#"+d(n.value.reporter?.id),1)])])]),e("section",Le,[s[16]||(s[16]=e("h3",{class:"section-title"},"ìƒì„¸ ë‚´ìš©",-1)),e("p",Ve,d(n.value.description||"-"),1)])]),e("div",Be,[s[21]||(s[21]=e("h3",{class:"section-title"},"ì‹ ê³  ëŒ€ìƒ ì½˜í…ì¸  (ì¦ê±° ìë£Œ)",-1)),n.value.targetType==="REVIEW"?(o(),r("div",qe,[e("div",Ge,[e("span",Ue,"ë¦¬ë·° ID: #"+d(n.value.targetId),1),e("span",We,"ì‘ì„±ì: "+d(n.value.targetData?.reviewAuthorName||"ì•Œ ìˆ˜ ì—†ìŒ"),1)]),e("div",{class:j(["evidence-content",{blurred:!w.value}])},[e("div",ze,[s[17]||(s[17]=e("span",{class:"star"},"â˜…",-1)),te(" "+d(n.value.targetData?.reviewRating?.toFixed(1)),1)]),e("p",Fe,d(n.value.targetData?.reviewContent),1),n.value.targetData?.reviewImages?.length?(o(),r("div",Qe,[(o(!0),r(T,null,B(n.value.targetData.reviewImages,(g,_)=>(o(),r("img",{key:_,src:g,alt:"ë¦¬ë·° ì´ë¯¸ì§€"},null,8,Xe))),128))])):m("",!0)],2),w.value?m("",!0):(o(),r("div",{key:0,class:"blind-overlay",onClick:f},[...s[18]||(s[18]=[e("span",{class:"blind-msg"},"âš ï¸ ì½˜í…ì¸  í™•ì¸í•˜ê¸° (í´ë¦­)",-1)])]))])):n.value.targetType==="USER"?(o(),r("div",je,[...s[19]||(s[19]=[e("p",null,"ì‚¬ìš©ì í”„ë¡œí•„ ì •ë³´ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.",-1)])])):n.value.targetType==="ACCOMMODATION"?(o(),r("div",He,[...s[20]||(s[20]=[e("p",null,"ìˆ™ì†Œ ì •ë³´ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.",-1)])])):m("",!0)])])):m("",!0),n.value?(o(),r("footer",Ke,[e("div",Ye,[e("button",{class:"btn btn-ghost",onClick:s[1]||(s[1]=g=>i.$emit("close"))},"ë‹«ê¸°")]),e("div",Je,[x.value?(o(),r(T,{key:0},[e("button",{class:"btn btn-neutral",onClick:s[2]||(s[2]=g=>$("ignore"))},"ì‹ ê³  ë°˜ë ¤"),n.value.targetType==="REVIEW"?(o(),r("button",{key:0,class:"btn btn-danger",onClick:s[3]||(s[3]=g=>$("blind"))}," ë¸”ë¼ì¸ë“œ ì²˜ë¦¬ ")):m("",!0),n.value.targetType==="USER"||n.value.targetType==="ACCOMMODATION"?(o(),r("button",{key:1,class:"btn btn-danger",onClick:s[4]||(s[4]=g=>$("ban"))}," ì œì¬ ì²˜ë¦¬ ")):m("",!0)],64)):(o(),r("span",Ze,"ì´ë¯¸ ì²˜ë¦¬ëœ ì‹ ê³ ì…ë‹ˆë‹¤."))])])):m("",!0)])])):m("",!0)}},tt=F(et,[["__scopeId","data-v-77ff8a89"]]),st={class:"admin-page"},lt={class:"admin-grid"},nt={class:"admin-filter-bar"},at={class:"admin-filter-group"},ot={class:"admin-filter-group"},it={class:"admin-filter-group"},rt={class:"admin-dropdown"},dt={class:"admin-dropdown__menu"},ut={class:"admin-table--nowrap admin-table--tight admin-table--stretch"},ct={class:"admin-strong admin-align-center"},vt={class:"admin-align-center"},pt={class:"admin-align-left"},mt={class:"reason-cell"},yt=["title"],bt={key:0,class:"reporter-info"},gt={class:"admin-align-center"},ft={class:"admin-align-center"},_t={class:"admin-align-center"},wt=["onClick"],kt={key:0,class:"admin-status"},ht={key:1,class:"admin-status"},It={key:2,class:"admin-status"},Dt={class:"admin-pagination"},$t=["disabled"],Ct=["disabled"],Et={__name:"AdminReportsView",setup(A){const R=c([]),y=c([]),b=c(""),n=c("all"),v=c("all"),u=c(0),w=c(20),h=c(0),S=c(0),E=c(!1),I=c(""),D=c(!1),x=c(null),$=c(!1),f=le(),i=ie(),s={REVIEW:{label:"ë¦¬ë·°",color:"blue",icon:"ğŸ“"},USER:{label:"ì‚¬ìš©ì",color:"green",icon:"ğŸ‘¤"},ACCOMMODATION:{label:"ìˆ™ì†Œ",color:"purple",icon:"ğŸ "}},g={WAIT:{label:"ëŒ€ê¸°ì¤‘",color:"yellow"},PENDING:{label:"ëŒ€ê¸°ì¤‘",color:"yellow"},PROCESSED:{label:"ì²˜ë¦¬ì™„ë£Œ",color:"green"},BLIND:{label:"ë¸”ë¼ì¸ë“œ",color:"green"},IGNORED:{label:"ë°˜ë ¤ë¨",color:"gray"}},_=async()=>{E.value=!0,I.value="";const a=await ce({status:n.value==="all"?void 0:n.value,type:v.value==="all"?void 0:v.value,keyword:b.value||void 0,page:u.value,size:w.value,sort:"latest"});if(a.ok&&a.data){const l=a.data;y.value=ye(l);const t=be(l);u.value=t.page,w.value=t.size,h.value=t.totalPages,S.value=t.totalElements;const p=y.value.filter(k=>k.status==="WAIT"||k.status==="PENDING").length,C=y.value.filter(k=>k.status==="PROCESSED"||k.status==="BLIND").length,O=y.value.filter(k=>k.status==="IGNORED").length;R.value=[{label:"ëŒ€ê¸°ì¤‘",value:`${p}ê±´`,sub:"í˜„ì¬ í˜ì´ì§€ ê¸°ì¤€",tone:"warning"},{label:"ì²˜ë¦¬ì™„ë£Œ",value:`${C}ê±´`,sub:"í˜„ì¬ í˜ì´ì§€ ê¸°ì¤€",tone:"success"},{label:"ë°˜ë ¤ë¨",value:`${O}ê±´`,sub:"í˜„ì¬ í˜ì´ì§€ ê¸°ì¤€",tone:"neutral"}]}else I.value="ì‹ ê³  ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.";E.value=!1},K=a=>{const l={...f.query,...a},t=z(l),p=z(f.query);Object.keys({...t,...p}).every(O=>String(t[O]??"")===String(p[O]??""))||i.replace({query:t})};Q(()=>{n.value=f.query.status??"all",v.value=f.query.type??"all",b.value=f.query.keyword??"",u.value=Number(f.query.page??0),_()});const N=a=>s[a]||{label:a,color:"gray",icon:"â“"},P=a=>g[a]||{label:a,color:"neutral"},M=X(()=>{const a=b.value.trim().toLowerCase();return y.value.filter(l=>{const t=!a||String(l.reportId??"").includes(a)||(l.reason??"").toLowerCase().includes(a),p=n.value==="all"||l.status===n.value,C=v.value==="all"||l.targetType===v.value;return t&&p&&C})});ne([b,n,v],()=>{u.value=0,K({status:n.value,type:v.value,keyword:b.value||void 0,page:u.value}),_()});const Y=a=>{a?.reportId&&(x.value=a.reportId,D.value=!0)},q=()=>{D.value=!1,x.value=null},J=async(a,l)=>{if(!l?.reportId)return;let t="",p="";if(a==="ignore"){if(!confirm("ì‹ ê³ ë¥¼ ë°˜ë ¤í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))return;t="IGNORED",p="ê´€ë¦¬ìì— ì˜í•´ ë°˜ë ¤ë¨"}else if(a==="blind"){if(!confirm("í•´ë‹¹ ì½˜í…ì¸ ë¥¼ ë¸”ë¼ì¸ë“œ ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))return;t="BLIND",p="ë¶€ì ì ˆí•œ ì½˜í…ì¸ ë¡œ ë¸”ë¼ì¸ë“œ ì²˜ë¦¬"}else if(a==="ban"){if(!confirm("í•´ë‹¹ ì‚¬ìš©ìë¥¼ ì •ì§€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))return;t="PROCESSED",p="ì‹ ê³  ëˆ„ì ìœ¼ë¡œ ì¸í•œ ê³„ì • ì •ì§€"}else return;$.value=!0;const C=await ve(l.reportId,{action:t,memo:p});$.value=!1,C.ok?(alert("ì²˜ë¦¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."),q(),_()):alert("ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")},G=a=>{const l=new Date().toISOString().slice(0,10),t=[{name:"ì‹ ê³  ëª©ë¡",columns:[{key:"reportId",label:"ì‹ ê³ ID"},{key:"targetType",label:"ìœ í˜•"},{key:"reason",label:"ì‚¬ìœ "},{key:"createdAt",label:"ì‹ ê³  ì¼ì‹œ"},{key:"status",label:"ìƒíƒœ"}],rows:M.value}];if(a==="xlsx"){pe({filename:`admin-reports-${l}.xlsx`,sheets:t});return}me({filename:`admin-reports-${l}.csv`,sheets:t})},Z=a=>a?String(a).replace("T"," ").slice(0,16):"-";return(a,l)=>(o(),r("section",st,[l[14]||(l[14]=e("header",{class:"admin-page__header"},[e("div",null,[e("h1",{class:"admin-title"},"ì‹ ê³  ê´€ë¦¬"),e("p",{class:"admin-subtitle"},"ì‹ ê³  ì ‘ìˆ˜ í˜„í™©ê³¼ ì²˜ë¦¬ ë‹¨ê³„ë¥¼ ì¶”ì í•©ë‹ˆë‹¤.")])],-1)),e("div",lt,[(o(!0),r(T,null,B(R.value,t=>(o(),V(re,{key:t.label,label:t.label,value:t.value,sub:t.sub,tone:t.tone},null,8,["label","value","sub","tone"]))),128))]),e("div",nt,[e("div",at,[l[7]||(l[7]=e("span",{class:"admin-chip"},"ê²€ìƒ‰",-1)),L(e("input",{"onUpdate:modelValue":l[0]||(l[0]=t=>b.value=t),class:"admin-input",type:"search",placeholder:"ì‹ ê³ ID, ì‚¬ìœ "},null,512),[[ae,b.value]])]),e("div",ot,[l[10]||(l[10]=e("span",{class:"admin-chip"},"í•„í„°",-1)),L(e("select",{"onUpdate:modelValue":l[1]||(l[1]=t=>v.value=t),class:"admin-select"},[...l[8]||(l[8]=[e("option",{value:"all"},"ì „ì²´ ìœ í˜•",-1),e("option",{value:"REVIEW"},"ë¦¬ë·°",-1),e("option",{value:"USER"},"íšŒì›",-1),e("option",{value:"ACCOMMODATION"},"ìˆ™ì†Œ",-1)])],512),[[W,v.value]]),L(e("select",{"onUpdate:modelValue":l[2]||(l[2]=t=>n.value=t),class:"admin-select"},[...l[9]||(l[9]=[e("option",{value:"all"},"ì „ì²´ ìƒíƒœ",-1),e("option",{value:"WAIT"},"ëŒ€ê¸°ì¤‘",-1),e("option",{value:"PROCESSED"},"ì²˜ë¦¬ì™„ë£Œ",-1),e("option",{value:"IGNORED"},"ë°˜ë ¤ë¨",-1)])],512),[[W,n.value]])]),e("div",it,[e("details",rt,[l[11]||(l[11]=e("summary",{class:"admin-btn admin-btn--ghost"},"ë‹¤ìš´ë¡œë“œ",-1)),e("div",dt,[e("button",{class:"admin-btn admin-btn--ghost admin-dropdown__item",type:"button",onClick:l[3]||(l[3]=t=>G("csv"))},"CSV"),e("button",{class:"admin-btn admin-btn--primary admin-dropdown__item",type:"button",onClick:l[4]||(l[4]=t=>G("xlsx"))},"XLSX")])])])]),U(de,{title:"ì‹ ê³  ëª©ë¡"},{default:oe(()=>[e("table",ut,[l[12]||(l[12]=e("colgroup",null,[e("col",{style:{width:"100px"}}),e("col",{style:{width:"120px"}}),e("col",{style:{width:"200px"}}),e("col",{style:{width:"160px"}}),e("col",{style:{width:"120px"}}),e("col",{style:{width:"100px"}})],-1)),l[13]||(l[13]=e("thead",null,[e("tr",null,[e("th",{class:"admin-align-center"},"ì‹ ê³ ID"),e("th",{class:"admin-align-center"},"ìœ í˜•"),e("th",{class:"admin-align-left"},"ì‹ ê³  ì‚¬ìœ "),e("th",{class:"admin-align-center"},"ì‹ ê³  ì¼ì‹œ"),e("th",{class:"admin-align-center"},"ìƒíƒœ"),e("th",{class:"admin-align-center"},"ê´€ë¦¬")])],-1)),e("tbody",null,[(o(!0),r(T,null,B(M.value,t=>(o(),r("tr",{key:t.reportId},[e("td",ct,"#"+d(t.reportId),1),e("td",vt,[e("span",{class:j(["type-badge",`type-badge--${N(t.targetType).color}`])},d(N(t.targetType).icon)+" "+d(N(t.targetType).label),3)]),e("td",pt,[e("div",mt,[e("span",{class:"admin-strong admin-ellipsis",title:t.reason},d(t.reason),9,yt),t.reporterId?(o(),r("span",bt,"(by #"+d(t.reporterId)+")",1)):m("",!0)])]),e("td",gt,d(Z(t.createdAt)),1),e("td",ft,[U(H,{text:P(t.status).label,variant:P(t.status).color==="yellow"?"warning":P(t.status).color==="green"?"success":"neutral"},null,8,["text","variant"])]),e("td",_t,[e("button",{class:"admin-btn admin-btn--ghost",type:"button",onClick:p=>Y(t)},"ìƒì„¸",8,wt)])]))),128))])]),E.value?(o(),r("div",kt,"ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...")):I.value?(o(),r("div",ht,[e("span",null,d(I.value),1),e("button",{class:"admin-btn admin-btn--ghost",type:"button",onClick:_},"ë‹¤ì‹œ ì‹œë„")])):M.value.length?m("",!0):(o(),r("div",It,"ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.")),e("div",Dt,[e("button",{class:"admin-btn admin-btn--ghost",type:"button",disabled:u.value<=0,onClick:l[5]||(l[5]=t=>{u.value=u.value-1,_()})}," ì´ì „ ",8,$t),e("span",null,d(u.value+1)+" / "+d(Math.max(h.value,1)),1),e("button",{class:"admin-btn admin-btn--ghost",type:"button",disabled:u.value+1>=h.value,onClick:l[6]||(l[6]=t=>{u.value=u.value+1,_()})}," ë‹¤ìŒ ",8,Ct)])]),_:1}),D.value?(o(),V(tt,{key:0,"report-id":x.value,"is-open":D.value,onClose:q,onAction:J},null,8,["report-id","is-open"])):m("",!0)]))}},Pt=F(Et,[["__scopeId","data-v-0a5180b7"]]);export{Pt as default};
