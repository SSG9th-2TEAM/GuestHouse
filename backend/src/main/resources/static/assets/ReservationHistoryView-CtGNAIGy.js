import{_ as U,r as y,q as b,b as M,c as l,e as t,p as B,k as L,t as n,F as _,f,i as P,K as V,o as a,w as S,A as c,n as A,l as F,H as q,z}from"./index-GmEodlcO.js";import{getMyReservations as T,deleteCompletedReservation as E}from"./reservationApi-cWcUR7BE.js";const W={class:"reservation-page container"},Y={class:"header-section"},j={key:0,class:"loading-state"},G={key:1,class:"error-state"},J={class:"section"},O={key:0,class:"empty-state"},Q={key:1,class:"card-list"},X=["onClick","onKeydown"],Z={class:"card-content"},ss=["src","alt"],ts={class:"card-info"},os={class:"res-title"},es={class:"res-loc"},ns={class:"res-details"},as={class:"val"},ls={class:"res-details"},cs={class:"val"},is={class:"res-details"},rs={class:"val"},ds={class:"val"},us={class:"res-price"},vs={class:"price-val"},ps=["onClick"],ks={class:"section"},_s={key:0,class:"empty-state"},hs={key:1,class:"card-list"},ms={class:"card-content"},gs=["src","alt"],ys={class:"card-info"},bs={class:"res-title"},fs={class:"res-loc"},ws={class:"res-details"},Cs={class:"val"},Is={class:"res-details"},Ds={class:"val"},$s={class:"val"},Ns={class:"section"},Rs={key:0,class:"empty-state"},Ss={key:1,class:"card-list"},As=["onClick","onKeydown"],Hs={class:"card-content"},xs=["src","alt"],Ks={class:"card-info"},Us={class:"res-title"},Ms={class:"res-loc"},Bs={class:"res-details"},Ls={class:"val"},Ps={class:"res-details"},Vs={class:"val"},Fs={class:"val"},qs={class:"res-price"},zs={class:"price-val"},Ts=["onClick","disabled"],Es={key:1,class:"action-btn review completed",disabled:""},Ws=["onClick","disabled","title"],Ys={__name:"ReservationHistoryView",setup(js){const u=L(),h=y(!0),p=y(""),v=y([]),m=new Date;m.setHours(0,0,0,0);const w=b(()=>v.value.filter(e=>{const s=new Date(e.checkin);return s.setHours(0,0,0,0),s>=m&&e.reservationStatus===2})),C=b(()=>v.value.filter(e=>{const s=new Date(e.checkin);return s.setHours(0,0,0,0),s<m&&e.reservationStatus===2})),I=b(()=>v.value.filter(e=>e.reservationStatus===9)),i=e=>{const s=new Date(e),d=s.getFullYear(),o=String(s.getMonth()+1).padStart(2,"0"),r=String(s.getDate()).padStart(2,"0");return`${d}.${o}.${r}`},k=e=>e||"",g=e=>{const s=new Date(e);s.setHours(0,0,0,0);const d=new Date(s);d.setDate(d.getDate()+7);const o=new Date;return o.setHours(0,0,0,0),o<=d},D=e=>new Date>=new Date(e),$=async()=>{try{if(h.value=!0,p.value="",!P()){u.push("/login");return}const e=await T();v.value=e||[]}catch(e){console.error("ì˜ˆì•½ ì¡°íšŒ ì‹¤íŒ¨:",e),p.value="ì˜ˆì•½ ë‚´ì—­ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."}finally{h.value=!1}},H=e=>{u.push({name:"reservation-cancel",params:{id:e.reservationId},state:{reservationData:{id:e.reservationId,accommodationName:e.accommodationName,location:e.accommodationAddress,checkin:i(e.checkin),checkout:i(e.checkout),guests:e.guestCount,price:e.finalPaymentAmount,image:k(e.accommodationImageUrl)||`https://picsum.photos/seed/${e.accommodationsId}/200/200`}}})},x=async e=>{if(confirm("ë‚´ì—­ì—ì„œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))try{await E(e),v.value=v.value.filter(s=>s.reservationId!==e)}catch(s){console.error("ì‚­ì œ ì‹¤íŒ¨:",s),p.value="ì´ìš© ì™„ë£Œëœ ì˜ˆì•½ë§Œ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."}},N=e=>{u.push({name:"booking-success",query:{reservationId:e.reservationId}})},R=e=>{u.push(`/room/${e.accommodationsId}`)},K=e=>{u.push({name:"write-review",state:{reservationData:{reservationId:e.reservationId,accommodationId:e.accommodationsId,accommodationName:e.accommodationName,dates:`${i(e.checkin)} ~ ${i(e.checkout)}`}}})};return M(()=>{$()}),(e,s)=>{const d=V("router-link");return a(),l("div",W,[t("div",Y,[t("button",{class:"back-btn",onClick:s[0]||(s[0]=o=>B(u).back())},"â†"),s[3]||(s[3]=t("h1",{class:"page-title"},"ì˜ˆì•½ ë‚´ì—­",-1))]),h.value?(a(),l("div",j,[...s[4]||(s[4]=[t("p",null,"ì˜ˆì•½ ë‚´ì—­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...",-1)])])):p.value?(a(),l("div",G,[t("p",null,n(p.value),1),t("button",{onClick:$,class:"retry-btn"},"ë‹¤ì‹œ ì‹œë„")])):(a(),l(_,{key:2},[t("section",J,[s[14]||(s[14]=t("h2",{class:"section-title"},"ì˜ˆì•½ ë‚´ì—­",-1)),w.value.length===0?(a(),l("div",O," ì˜ˆì•½ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤. ")):(a(),l("div",Q,[(a(!0),l(_,null,f(w.value,o=>(a(),l("div",{key:o.reservationId,class:"res-card clickable",role:"link",tabindex:"0",onClick:r=>N(o),onKeydown:S(r=>N(o),["enter"])},[t("div",Z,[t("img",{src:k(o.accommodationImageUrl)||`https://picsum.photos/seed/${o.accommodationsId}/200/200`,class:"card-img",alt:o.accommodationName||"ìˆ™ì†Œ ì´ë¯¸ì§€"},null,8,ss),t("div",ts,[t("h3",os,n(o.accommodationName||"ìˆ™ì†Œëª… ì—†ìŒ"),1),t("p",es,n(o.accommodationAddress||"ì£¼ì†Œ ì—†ìŒ"),1),t("div",ns,[s[5]||(s[5]=t("span",null,"ì²´í¬ì¸",-1)),s[6]||(s[6]=c()),t("span",as,n(i(o.checkin)),1)]),t("div",ls,[s[7]||(s[7]=t("span",null,"ì²´í¬ì•„ì›ƒ",-1)),s[8]||(s[8]=c()),t("span",cs,n(i(o.checkout)),1)]),t("div",is,[s[9]||(s[9]=t("span",null,"ì¸ì›",-1)),s[10]||(s[10]=c()),t("span",rs,n(o.guestCount)+"ëª…",1),s[11]||(s[11]=t("span",{class:"spacer"},"ìˆ™ë°•",-1)),s[12]||(s[12]=c()),t("span",ds,n(o.stayNights)+"ë°•",1)]),t("div",us,[s[13]||(s[13]=c(" ê²°ì œê¸ˆì•¡ ",-1)),t("span",vs,n(o.finalPaymentAmount?.toLocaleString()||0)+"ì›",1)])])]),t("div",{class:"card-actions",onClick:s[1]||(s[1]=A(()=>{},["stop"]))},[t("button",{class:"action-btn outline",onClick:r=>H(o)},"ì˜ˆì•½ ì·¨ì†Œ",8,ps)])],40,X))),128))]))]),t("section",ks,[s[22]||(s[22]=t("h2",{class:"section-title"},"ì·¨ì†Œ ë‚´ì—­",-1)),I.value.length===0?(a(),l("div",_s," ì·¨ì†Œ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤. ")):(a(),l("div",hs,[(a(!0),l(_,null,f(I.value,o=>(a(),F(d,{key:o.reservationId,to:`/room/${o.accommodationsId}`,class:"res-card clickable cancelled"},{default:q(()=>[t("div",ms,[t("img",{src:k(o.accommodationImageUrl)||`https://picsum.photos/seed/${o.accommodationsId}/200/200`,class:"card-img",alt:o.accommodationName||"ìˆ™ì†Œ ì´ë¯¸ì§€"},null,8,gs),t("div",ys,[s[21]||(s[21]=t("div",{class:"cancelled-badge"},"ì·¨ì†Œë¨",-1)),t("h3",bs,n(o.accommodationName||"ìˆ™ì†Œëª… ì—†ìŒ"),1),t("p",fs,n(o.accommodationAddress||"ì£¼ì†Œ ì—†ìŒ"),1),t("div",ws,[s[15]||(s[15]=t("span",null,"ì˜ˆì•½ì¼",-1)),s[16]||(s[16]=c()),t("span",Cs,n(i(o.checkin))+" ~ "+n(i(o.checkout)),1)]),t("div",Is,[s[17]||(s[17]=t("span",null,"ì¸ì›",-1)),s[18]||(s[18]=c()),t("span",Ds,n(o.guestCount)+"ëª…",1),s[19]||(s[19]=t("span",{class:"spacer"},"ìˆ™ë°•",-1)),s[20]||(s[20]=c()),t("span",$s,n(o.stayNights)+"ë°•",1)])])])]),_:2},1032,["to"]))),128))]))]),t("section",Ns,[s[30]||(s[30]=t("h2",{class:"section-title"},"ì´ìš© ì™„ë£Œ",-1)),C.value.length===0?(a(),l("div",Rs," ì´ìš© ì™„ë£Œëœ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤. ")):(a(),l("div",Ss,[(a(!0),l(_,null,f(C.value,o=>(a(),l("div",{key:o.reservationId,class:"res-card clickable",role:"link",tabindex:"0",onClick:r=>R(o),onKeydown:S(r=>R(o),["enter"])},[t("div",Hs,[t("img",{src:k(o.accommodationImageUrl)||`https://picsum.photos/seed/${o.accommodationsId}/200/200`,class:"card-img",alt:o.accommodationName||"ìˆ™ì†Œ ì´ë¯¸ì§€"},null,8,xs),t("div",Ks,[t("h3",Us,n(o.accommodationName||"ìˆ™ì†Œëª… ì—†ìŒ"),1),t("p",Ms,n(o.accommodationAddress||"ì£¼ì†Œ ì—†ìŒ"),1),t("div",Bs,[s[23]||(s[23]=t("span",null,"ì´ìš©ì¼",-1)),s[24]||(s[24]=c()),t("span",Ls,n(i(o.checkin))+" ~ "+n(i(o.checkout)),1)]),t("div",Ps,[s[25]||(s[25]=t("span",null,"ì¸ì›",-1)),s[26]||(s[26]=c()),t("span",Vs,n(o.guestCount)+"ëª…",1),s[27]||(s[27]=t("span",{class:"spacer"},"ìˆ™ë°•",-1)),s[28]||(s[28]=c()),t("span",Fs,n(o.stayNights)+"ë°•",1)]),t("div",qs,[s[29]||(s[29]=c(" ê²°ì œê¸ˆì•¡ ",-1)),t("span",zs,n(o.finalPaymentAmount?.toLocaleString()||0)+"ì›",1)])])]),t("div",{class:"card-actions",onClick:s[2]||(s[2]=A(()=>{},["stop"]))},[o.hasReview?(a(),l("button",Es," ë¦¬ë·° ë“±ë¡ ì™„ë£Œ ")):(a(),l("button",{key:0,class:z(["action-btn review",{disabled:!g(o.checkout)}]),onClick:r=>K(o),disabled:!g(o.checkout)},n(g(o.checkout)?"ë¦¬ë·° ì‘ì„±í•˜ê¸°":"ì‘ì„± ê¸°í•œ ë§Œë£Œ"),11,Ts)),t("button",{class:"icon-btn delete",onClick:r=>x(o.reservationId),disabled:!D(o.checkout),title:D(o.checkout)?"ë‚´ì—­ ì‚­ì œ":"ì´ìš© ì™„ë£Œ í›„ ì‚­ì œ ê°€ëŠ¥"},"ğŸ—‘",8,Ws)])],40,As))),128))]))])],64))])}}},Os=U(Ys,[["__scopeId","data-v-af6a1f2d"]]);export{Os as default};
