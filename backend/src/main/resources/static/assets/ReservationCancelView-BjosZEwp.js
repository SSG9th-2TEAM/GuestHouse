import{_ as J,r as o,s as O,b as P,J as x,q as f,c as n,e,p as S,k as K,F as T,d as $,t as l,A as c,z as i,f as j,C as B,K as G,n as I,o as u,L as H}from"./index-B9EiY-js.js";const W={class:"cancel-page container"},X={class:"page-header"},Y={key:0,class:"loading-state"},Z={class:"info-card"},ee=["src"],se={class:"info-content"},te={class:"loc"},ae={class:"date"},oe={class:"guests"},ne={class:"refund-guide"},le={key:0,class:"refund-status"},ue={key:1,class:"refund-status refund-status--error"},ie={class:"days-info"},re={class:"days"},de={class:"refund-amount"},ce={class:"reason-section"},ve={class:"reason-list"},pe=["value"],me={class:"method-section"},fe={class:"method-box"},ye={key:0,class:"warning-box"},ke={key:1,class:"warning-box"},_e={class:"agreement"},be={class:"bottom-bar"},ge=["disabled"],he={class:"modal-content"},Ce={key:0},Ne={key:1},Re={key:2},we={class:"modal-message"},Me={__name:"ReservationCancelView",setup(xe){const h=K(),y=O(),A=o(!0);o("");const r=o({id:y.params.id,accommodationName:"",location:"",checkin:"",checkout:"",guests:1,price:0,image:""}),C=o({paymentMethod:"",approvedAmount:0}),N=o(!1),v=o(""),k=o(null);P(async()=>{try{if(history.state&&history.state.reservationData){const a=history.state.reservationData;r.value={id:a.id,accommodationName:a.accommodationName,location:a.location,checkin:a.checkin,checkout:a.checkout,guests:a.guests,price:a.price,image:a.image}}const t=y.params.id,s=await x(`/api/payments/reservation/${t}`);s.ok&&s.data&&(C.value={paymentMethod:s.data.paymentMethod||"ì¹´ë“œ",approvedAmount:s.data.approvedAmount||r.value.price}),await F(t)}catch(t){console.error("ê²°ì œ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨:",t),C.value.approvedAmount=r.value.price,await F(y.params.id)}finally{A.value=!1}});const d=f(()=>{const t=Number(k.value?.daysBefore);return Number.isFinite(t)?t:0}),V=f(()=>{const t=Number(k.value?.refundRate);return Number.isFinite(t)?t:0}),R=f(()=>{const t=Number(k.value?.refundAmount);return Number.isFinite(t)?t:0}),_=f(()=>V.value>0),m=o(""),w=o(!1),M=o(!1),L=o(""),b=o("info"),g=o(null),p=(t,s="info",a=null)=>{L.value=t,b.value=s,g.value=a,M.value=!0},D=()=>{M.value=!1,g.value&&(g.value(),g.value=null)},Q=f(()=>{const t=C.value.paymentMethod;return t?t==="ì¹´ë“œ"||t==="CARD"?"ì‹ ìš©/ì²´í¬ì¹´ë“œ":t==="ê°„í¸ê²°ì œ"?"ê°„í¸ê²°ì œ":t==="ê³„ì¢Œì´ì²´"?"ê³„ì¢Œì´ì²´":t:"ê²°ì œ ìˆ˜ë‹¨"}),q=async()=>{if(v.value){p(v.value,"error");return}if(!m.value.trim()){p("í™˜ë¶ˆ ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.","error");return}if(!w.value){p("í™˜ë¶ˆ ê·œì •ì— ë™ì˜í•´ì£¼ì„¸ìš”.","error");return}try{(await x("/api/payments/cancel",{method:"POST",body:JSON.stringify({reservationId:Number(y.params.id),cancelReason:m.value,refundAmount:R.value})})).ok?p(`í™˜ë¶ˆì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.
í™˜ë¶ˆ ê¸ˆì•¡: ${R.value.toLocaleString()}ì›`,"success",()=>h.push("/reservations")):p("í™˜ë¶ˆ ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}catch(t){console.error("í™˜ë¶ˆ ìš”ì²­ ì‹¤íŒ¨:",t),p("í™˜ë¶ˆ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.","error")}},U=()=>{window.open("/policy?tab=refund","_blank")},z=["ë°©ë¬¸ë¶ˆê°€/ì—¬í–‰ì·¨ì†Œ","íƒ€ ì„œë¹„ìŠ¤ì—ì„œ ë” ì‹¼ ìƒí’ˆ ë°œê²¬","ë‹¤ì‹œì˜ˆì•½_ê°™ì€ìˆ™ì†Œ ì¼ì •/ê°ì‹¤ ë³€ê²½","ë‹¤ë¥¸ ì˜ˆì•½_ë‹¤ë¥¸ìˆ™ì†Œë¡œ ë³€ê²½","ê²°ì œìˆ˜ë‹¨ë³€ê²½/ì¿ í°ì‚¬ìš©","ì—…ì²´ìš”ì²­","ë‹¨ìˆœë³€ì‹¬"],F=async t=>{if(!t)return;N.value=!0,v.value="";const s=await x(`/api/refunds/quote?reservationId=${t}`);s.ok&&s.data?k.value=s.data:v.value=s?.data?.message||"í™˜ë¶ˆ ê³„ì‚° ë¶ˆê°€",N.value=!1};return(t,s)=>(u(),n("div",W,[e("div",X,[e("button",{class:"back-btn",onClick:s[0]||(s[0]=a=>S(h).back())},"â†"),s[4]||(s[4]=e("h1",null,"ì˜ˆì•½ ì·¨ì†Œ",-1))]),A.value?(u(),n("div",Y,[...s[5]||(s[5]=[e("p",null,"ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...",-1)])])):(u(),n(T,{key:1},[e("div",Z,[e("img",{src:r.value.image||"https://picsum.photos/200/200",class:"info-img"},null,8,ee),e("div",se,[e("h3",null,l(r.value.accommodationName),1),e("p",te,l(r.value.location),1),e("p",ae,l(r.value.checkin)+" ~ "+l(r.value.checkout),1),e("p",oe,"ê²ŒìŠ¤íŠ¸ "+l(r.value.guests)+"ëª…",1)])]),e("div",ne,[s[12]||(s[12]=e("h3",null,"í™˜ë¶ˆ ê·œì •",-1)),N.value?(u(),n("div",le,"í™˜ë¶ˆ ê¸ˆì•¡ ê³„ì‚° ì¤‘...")):v.value?(u(),n("div",ue,l(v.value),1)):$("",!0),e("ul",null,[e("li",{class:c({active:d.value>=7})},[...s[6]||(s[6]=[i("ì²´í¬ì¸ 7ì¼ ì „: ",-1),e("strong",null,"100%",-1),i(" í™˜ë¶ˆ",-1)])],2),e("li",{class:c({active:d.value>=5&&d.value<7})},[...s[7]||(s[7]=[i("ì²´í¬ì¸ 5~6ì¼ ì „: ",-1),e("strong",null,"90%",-1),i(" í™˜ë¶ˆ",-1)])],2),e("li",{class:c({active:d.value>=3&&d.value<5})},[...s[8]||(s[8]=[i("ì²´í¬ì¸ 3~4ì¼ ì „: ",-1),e("strong",null,"70%",-1),i(" í™˜ë¶ˆ",-1)])],2),e("li",{class:c({active:d.value>=1&&d.value<3})},[...s[9]||(s[9]=[i("ì²´í¬ì¸ 1~2ì¼ ì „: ",-1),e("strong",null,"50%",-1),i(" í™˜ë¶ˆ",-1)])],2),e("li",{class:c({active:d.value<1,"no-refund":!0})},[...s[10]||(s[10]=[i("ì²´í¬ì¸ ë‹¹ì¼ ë˜ëŠ” ë…¸ì‡¼: ",-1),e("strong",null,"í™˜ë¶ˆ ë¶ˆê°€",-1)])],2)]),e("div",ie,[s[11]||(s[11]=e("span",null,"ì²´í¬ì¸ê¹Œì§€",-1)),e("span",re,l(d.value)+"ì¼",1)]),e("div",de,[e("span",null,"ì˜ˆìƒ í™˜ë¶ˆ ê¸ˆì•¡ ("+l(V.value)+"%)",1),e("span",{class:c(["amount",{"no-refund":!_.value}])},"â‚©"+l(R.value.toLocaleString()),3)])]),e("div",ce,[s[13]||(s[13]=e("h3",null,"ì·¨ì†Œ ì‚¬ìœ ",-1)),e("div",ve,[(u(),n(T,null,j(z,a=>e("label",{key:a,class:c(["reason-item",{selected:m.value===a}])},[B(e("input",{type:"radio","onUpdate:modelValue":s[1]||(s[1]=E=>m.value=E),value:a},null,8,pe),[[H,m.value]]),e("span",null,l(a),1)],2)),64))])]),e("div",me,[s[15]||(s[15]=e("h3",null,"í™˜ë¶ˆ ìˆ˜ë‹¨",-1)),e("div",fe,[s[14]||(s[14]=e("span",null,"ğŸ’³",-1)),e("span",null,l(Q.value)+"ë¡œ ê²°ì œí•œ ê¸ˆì•¡ì´ í™˜ë¶ˆë©ë‹ˆë‹¤",1)])]),_.value?(u(),n("div",ke,[...s[17]||(s[17]=[e("p",null,"âš ï¸ ì·¨ì†Œ í›„ì—ëŠ” ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",-1)])])):(u(),n("div",ye,[...s[16]||(s[16]=[e("p",null,"âš ï¸ ì²´í¬ì¸ ë‹¹ì¼ì€ í™˜ë¶ˆì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.",-1)])])),e("label",_e,[B(e("input",{type:"checkbox","onUpdate:modelValue":s[2]||(s[2]=a=>w.value=a)},null,512),[[G,w.value]]),e("span",null,[s[18]||(s[18]=i(" ìœ„ ",-1)),e("a",{href:"#",onClick:I(U,["prevent"]),class:"policy-link"},"í™˜ë¶ˆ ê·œì •"),s[19]||(s[19]=i("ì„ í™•ì¸í•˜ê³  ë™ì˜í•©ë‹ˆë‹¤. ",-1))])]),e("div",be,[e("button",{class:"cancel-btn outline",onClick:s[3]||(s[3]=a=>S(h).back())},"ë’¤ë¡œê°€ê¸°"),e("button",{class:c(["cancel-btn primary",{disabled:!_.value}]),onClick:q,disabled:!_.value}," í™˜ë¶ˆ ìš”ì²­ ",10,ge)]),M.value?(u(),n("div",{key:2,class:"modal-overlay",onClick:I(D,["self"])},[e("div",he,[e("div",{class:c(["modal-icon",b.value])},[b.value==="success"?(u(),n("span",Ce,"âœ“")):b.value==="error"?(u(),n("span",Ne,"!")):(u(),n("span",Re,"i"))],2),e("p",we,l(L.value),1),e("button",{class:"modal-btn",onClick:D},"í™•ì¸")])])):$("",!0)],64))]))}},Ve=J(Me,[["__scopeId","data-v-e83ddf12"]]);export{Ve as default};
