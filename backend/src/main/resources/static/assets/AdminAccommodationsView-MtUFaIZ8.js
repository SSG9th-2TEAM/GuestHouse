import{_ as dt,r as o,b as ut,s as rt,q as mt,y as vt,c as d,e as t,m as Q,d as b,C as $,E as X,I as ct,H as pt,t as l,k as bt,o as u,F as yt,f as gt}from"./index-DunUV3Ya.js";import{A as ft}from"./AdminBadge-onkglhq_.js";import{A as _t}from"./AdminTableCard-C7R_ncHs.js";import{e as kt,a as Ct}from"./reportExport-DvZZ7m0X.js";import{g as ht,h as J,i as wt,r as It}from"./adminApi-Dzdry8Ng.js";import{e as Rt,a as St,t as H}from"./adminData-ZmZ3C3cR.js";const At={class:"admin-page"},Dt={class:"admin-filter-bar"},Et={class:"admin-filter-group"},xt={class:"admin-filter-group"},Pt={class:"admin-filter-group"},Nt={class:"admin-dropdown"},Vt={class:"admin-dropdown__menu"},Lt={class:"admin-table--nowrap admin-table--tight"},$t={class:"admin-strong"},jt={class:"admin-strong"},Ut={class:"admin-inline-actions admin-inline-actions--nowrap"},Ot=["onClick"],qt=["onClick"],Tt=["onClick"],zt={key:0,class:"admin-status"},Ft={key:1,class:"admin-status"},Bt={key:2,class:"admin-status"},Gt={class:"admin-pagination"},Mt=["disabled"],Qt=["disabled"],Xt={key:0,class:"admin-modal"},Jt={class:"admin-modal__panel",role:"dialog","aria-modal":"true"},Ht={class:"admin-modal__header"},Kt={class:"admin-modal__title"},Wt={key:0,class:"admin-status"},Yt={key:1,class:"admin-status"},Zt={key:2,class:"admin-modal__body"},tn={class:"admin-modal__section"},nn={class:"admin-detail-grid"},an={class:"admin-modal__section"},ln={class:"admin-detail-grid"},sn={key:0},en={class:"admin-modal__section"},on={class:"admin-detail-grid"},dn={key:3,class:"admin-modal__actions"},un={key:1,class:"admin-modal"},rn={class:"admin-modal__panel",role:"dialog","aria-modal":"true"},mn={class:"admin-modal__header"},vn=["disabled"],cn={class:"admin-detail-grid"},pn={key:0,class:"admin-status"},bn={class:"admin-modal__actions"},yn=["disabled"],gn=["disabled"],fn={key:2,class:"admin-modal"},_n={class:"admin-modal__panel",role:"dialog","aria-modal":"true"},kn={class:"admin-modal__header"},Cn=["disabled"],hn={class:"admin-detail-grid"},wn=["disabled"],In={key:0,class:"admin-status"},Rn={class:"admin-modal__actions"},Sn=["disabled"],An=["disabled"],Dn={__name:"AdminAccommodationsView",setup(En){const j=o([]),y=o(""),c=o("all"),r=o(0),U=o(20),D=o(0),K=o(0),E=o(!1),I=o(""),C=o(!1),_=o(!1),g=o(""),e=o(null),x=o(!1),P=o(!1),i=o(!1),m=o(""),v=o(null),h=o(""),w=rt(),W=bt(),Y=["PENDING","APPROVED","REJECTED"],Z=a=>{if(!a)return"all";const n=String(a).toUpperCase().trim();return Y.includes(n)?n:"all"},p=async()=>{E.value=!0,I.value="";const a=await ht({status:c.value==="all"?void 0:c.value,keyword:y.value||void 0,page:r.value,size:U.value,sort:"latest"});if(a.ok&&a.data){const n=a.data;j.value=Rt(n);const s=St(n);r.value=s.page,U.value=s.size,D.value=s.totalPages,K.value=s.totalElements}else I.value="숙소 목록을 불러오지 못했습니다.";E.value=!1},O=a=>{const n={...w.query,...a},s=H(n),f=H(w.query);Object.keys({...s,...f}).every(M=>String(s[M]??"")===String(f[M]??""))||W.replace({query:s})};ut(()=>{c.value=Z(w.query.status),y.value=w.query.keyword??"",r.value=Number(w.query.page??0),p()});const tt=a=>a==="APPROVED"?"success":a==="PENDING"?"warning":a==="REJECTED"?"danger":"neutral",N=mt(()=>{const a=y.value.trim().toLowerCase();return j.value.filter(n=>{const s=!a||(n.name??"").toLowerCase().includes(a)||String(n.hostUserId??"").includes(a)||`${n.city??""} ${n.district??""}`.toLowerCase().includes(a)||String(n.accommodationsId??"").includes(a),f=c.value==="all"||n.approvalStatus===c.value;return s&&f})});vt([y,c],()=>{r.value=0,O({status:c.value,keyword:y.value||void 0,page:r.value}),p()});const nt=()=>{c.value="PENDING",r.value=0,O({status:c.value,page:r.value}),p()},q=a=>{a?.accommodationsId&&(v.value=a,m.value="",i.value=!1,x.value=!0)},T=a=>{a?.accommodationsId&&(v.value=a,h.value="",m.value="",i.value=!1,P.value=!0)},R=()=>{x.value=!1,v.value=null,m.value="",i.value=!1},S=()=>{P.value=!1,v.value=null,m.value="",i.value=!1,h.value=""},at=async()=>{if(!v.value?.accommodationsId)return;i.value=!0,m.value="";const a=await wt(v.value.accommodationsId);if(!a.ok){m.value=a?.data?.message||"승인 처리에 실패했습니다.",i.value=!1;return}R(),await p(),C.value&&await V()},lt=async()=>{if(!v.value?.accommodationsId)return;const a=h.value.trim();if(!a){m.value="반려 사유를 입력해주세요.";return}i.value=!0,m.value="";const n=await It(v.value.accommodationsId,a);if(!n.ok){m.value=n?.data?.message||"반려 처리에 실패했습니다.",i.value=!1;return}S(),await p(),C.value&&await V()},st=async a=>{if(!a?.accommodationsId)return;C.value=!0,_.value=!0,g.value="";const n=await J(a.accommodationsId);n.ok&&n.data?e.value=n.data:g.value="숙소 상세 정보를 불러오지 못했습니다.",_.value=!1},z=()=>{C.value=!1,g.value="",e.value=null},V=async()=>{if(!e.value?.accommodationsId)return;_.value=!0,g.value="";const a=await J(e.value.accommodationsId);a.ok&&a.data?e.value=a.data:g.value="숙소 상세 정보를 불러오지 못했습니다.",_.value=!1},et=()=>{e.value?.accommodationsId&&q(e.value)},ot=()=>{e.value?.accommodationsId&&T(e.value)},F=a=>{const n=new Date().toISOString().slice(0,10),s=[{name:"숙소 목록",columns:[{key:"accommodationsId",label:"ID"},{key:"name",label:"숙소명"},{key:"hostUserId",label:"호스트"},{key:"city",label:"도시"},{key:"district",label:"지역"},{key:"category",label:"유형"},{key:"createdAt",label:"등록일"},{key:"avgRating",label:"평점"},{key:"reviewCount",label:"리뷰 수"},{key:"reservationCount",label:"예약 수"},{key:"occupancyRate",label:"가동률"},{key:"cancellationRate",label:"취소율"},{key:"totalRevenue",label:"총 매출"},{key:"approvalStatus",label:"상태"}],rows:N.value}];if(a==="xlsx"){kt({filename:`admin-accommodations-${n}.xlsx`,sheets:s});return}Ct({filename:`admin-accommodations-${n}.csv`,sheets:s})},L=(a,n=!1)=>a==null?n?"₩0":"-":`₩${Number(a).toLocaleString()}`,k=(a,n=!1)=>a==null?n?"0":"-":Number(a).toLocaleString(),A=(a,n=!1)=>a==null?n?"0.0%":"-":`${Number(a).toFixed(1)}%`,B=a=>a==null?"-":Number(a).toFixed(1),G=a=>a?String(a).slice(0,10):"-",it=a=>a===1?"운영중":a===0?"운영정지":"-";return(a,n)=>(u(),d("section",At,[n[42]||(n[42]=t("header",{class:"admin-page__header"},[t("div",null,[t("h1",{class:"admin-title"},"숙소 관리"),t("p",{class:"admin-subtitle"},"등록 숙소 상태와 매출을 모니터링합니다.")])],-1)),t("div",Dt,[t("div",Et,[n[7]||(n[7]=t("span",{class:"admin-chip"},"검색",-1)),$(t("input",{"onUpdate:modelValue":n[0]||(n[0]=s=>y.value=s),class:"admin-input",type:"search",placeholder:"숙소명, 호스트, 지역, ID"},null,512),[[X,y.value]])]),t("div",xt,[n[9]||(n[9]=t("span",{class:"admin-chip"},"상태",-1)),$(t("select",{"onUpdate:modelValue":n[1]||(n[1]=s=>c.value=s),class:"admin-select"},[...n[8]||(n[8]=[t("option",{value:"all"},"전체 상태",-1),t("option",{value:"PENDING"},"승인 대기",-1),t("option",{value:"APPROVED"},"승인",-1),t("option",{value:"REJECTED"},"반려",-1)])],512),[[ct,c.value]])]),t("div",{class:"admin-filter-group"},[n[10]||(n[10]=t("span",{class:"admin-chip"},"작업",-1)),t("button",{class:"admin-btn admin-btn--primary",type:"button",onClick:nt},"대기 숙소 보기")]),t("div",Pt,[t("details",Nt,[n[11]||(n[11]=t("summary",{class:"admin-btn admin-btn--ghost"},"다운로드",-1)),t("div",Vt,[t("button",{class:"admin-btn admin-btn--ghost admin-dropdown__item",type:"button",onClick:n[2]||(n[2]=s=>F("csv"))},"CSV"),t("button",{class:"admin-btn admin-btn--primary admin-dropdown__item",type:"button",onClick:n[3]||(n[3]=s=>F("xlsx"))},"XLSX")])])])]),Q(_t,{title:"숙소 목록"},{default:pt(()=>[t("table",Lt,[n[12]||(n[12]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"숙소명"),t("th",null,"호스트"),t("th",null,"위치"),t("th",null,"평점"),t("th",null,"리뷰"),t("th",null,"예약"),t("th",null,"가동률"),t("th",null,"취소율"),t("th",null,"총 매출"),t("th",null,"등록일"),t("th",null,"상태"),t("th",null,"관리")])],-1)),t("tbody",null,[(u(!0),d(yt,null,gt(N.value,s=>(u(),d("tr",{key:s.accommodationsId},[t("td",$t,"#"+l(s.accommodationsId),1),t("td",jt,l(s.name),1),t("td",null,l(s.hostUserId),1),t("td",null,l(s.city)+" "+l(s.district),1),t("td",null,l(B(s.avgRating)),1),t("td",null,l(k(s.reviewCount)),1),t("td",null,l(k(s.reservationCount,!0)),1),t("td",null,l(A(s.occupancyRate,!0)),1),t("td",null,l(A(s.cancellationRate,!0)),1),t("td",null,l(L(s.totalRevenue,!0)),1),t("td",null,l(G(s.createdAt)),1),t("td",null,[Q(ft,{text:s.approvalStatus,variant:tt(s.approvalStatus)},null,8,["text","variant"])]),t("td",null,[t("div",Ut,[t("button",{class:"admin-btn admin-btn--ghost",type:"button",onClick:f=>st(s)},"상세",8,Ot),t("button",{class:"admin-btn admin-btn--primary",type:"button",onClick:f=>q(s)},"승인",8,qt),t("button",{class:"admin-btn admin-btn--muted",type:"button",onClick:f=>T(s)},"반려",8,Tt)])])]))),128))])]),E.value?(u(),d("div",zt,"불러오는 중...")):I.value?(u(),d("div",Ft,[t("span",null,l(I.value),1),t("button",{class:"admin-btn admin-btn--ghost",type:"button",onClick:p},"다시 시도")])):N.value.length?b("",!0):(u(),d("div",Bt,"조건에 맞는 숙소가 없습니다.")),t("div",Gt,[t("button",{class:"admin-btn admin-btn--ghost",type:"button",disabled:r.value<=0,onClick:n[4]||(n[4]=s=>{r.value=r.value-1,p()})}," 이전 ",8,Mt),t("span",null,l(r.value+1)+" / "+l(Math.max(D.value,1)),1),t("button",{class:"admin-btn admin-btn--ghost",type:"button",disabled:r.value+1>=D.value,onClick:n[5]||(n[5]=s=>{r.value=r.value+1,p()})}," 다음 ",8,Qt)])]),_:1}),C.value?(u(),d("div",Xt,[t("div",{class:"admin-modal__backdrop",onClick:z}),t("div",Jt,[t("div",Ht,[t("div",null,[n[13]||(n[13]=t("p",{class:"admin-modal__eyebrow"},"숙소 상세",-1)),t("h2",Kt,l(e.value?.name??"-"),1)]),t("button",{class:"admin-btn admin-btn--ghost",type:"button",onClick:z},"닫기")]),_.value?(u(),d("div",Wt,"불러오는 중...")):g.value?(u(),d("div",Yt,[t("span",null,l(g.value),1),t("button",{class:"admin-btn admin-btn--ghost",type:"button",onClick:V},"다시 시도")])):(u(),d("div",Zt,[t("div",tn,[n[23]||(n[23]=t("h3",null,"기본 정보",-1)),t("div",nn,[t("div",null,[n[14]||(n[14]=t("span",null,"ID",-1)),t("strong",null,"#"+l(e.value?.accommodationsId??"-"),1)]),t("div",null,[n[15]||(n[15]=t("span",null,"호스트",-1)),t("strong",null,l(e.value?.hostName??"-")+" ("+l(e.value?.hostUserId??"-")+")",1)]),t("div",null,[n[16]||(n[16]=t("span",null,"연락처",-1)),t("strong",null,l(e.value?.hostPhone??"-"),1)]),t("div",null,[n[17]||(n[17]=t("span",null,"주소",-1)),t("strong",null,l([e.value?.city,e.value?.district,e.value?.township,e.value?.addressDetail].filter(Boolean).join(" ")||"-"),1)]),t("div",null,[n[18]||(n[18]=t("span",null,"숙소 유형",-1)),t("strong",null,l(e.value?.category??"-"),1)]),t("div",null,[n[19]||(n[19]=t("span",null,"등록일",-1)),t("strong",null,l(G(e.value?.createdAt)),1)]),t("div",null,[n[20]||(n[20]=t("span",null,"객실 수",-1)),t("strong",null,l(k(e.value?.roomCount)),1)]),t("div",null,[n[21]||(n[21]=t("span",null,"최대 인원",-1)),t("strong",null,l(k(e.value?.maxGuests)),1)]),t("div",null,[n[22]||(n[22]=t("span",null,"1박 최저가",-1)),t("strong",null,l(L(e.value?.minPrice)),1)])])]),t("div",an,[n[27]||(n[27]=t("h3",null,"상태",-1)),t("div",ln,[t("div",null,[n[24]||(n[24]=t("span",null,"승인 상태",-1)),t("strong",null,l(e.value?.approvalStatus??"-"),1)]),t("div",null,[n[25]||(n[25]=t("span",null,"운영 상태",-1)),t("strong",null,l(it(e.value?.accommodationStatus)),1)]),e.value?.rejectionReason?(u(),d("div",sn,[n[26]||(n[26]=t("span",null,"반려 사유",-1)),t("strong",null,l(e.value?.rejectionReason),1)])):b("",!0)])]),t("div",en,[n[34]||(n[34]=t("h3",null,"지표 요약",-1)),t("div",on,[t("div",null,[n[28]||(n[28]=t("span",null,"평점",-1)),t("strong",null,l(B(e.value?.avgRating)),1)]),t("div",null,[n[29]||(n[29]=t("span",null,"리뷰 수",-1)),t("strong",null,l(k(e.value?.reviewCount)),1)]),t("div",null,[n[30]||(n[30]=t("span",null,"예약 수(확정)",-1)),t("strong",null,l(k(e.value?.reservationCount)),1)]),t("div",null,[n[31]||(n[31]=t("span",null,"가동률",-1)),t("strong",null,l(A(e.value?.occupancyRate)),1)]),t("div",null,[n[32]||(n[32]=t("span",null,"취소율",-1)),t("strong",null,l(A(e.value?.cancellationRate)),1)]),t("div",null,[n[33]||(n[33]=t("span",null,"총 매출(확정)",-1)),t("strong",null,l(L(e.value?.totalRevenue)),1)])])])])),_.value?b("",!0):(u(),d("div",dn,[t("button",{class:"admin-btn admin-btn--primary",type:"button",onClick:et},"승인"),t("button",{class:"admin-btn admin-btn--muted",type:"button",onClick:ot},"반려")]))])])):b("",!0),x.value?(u(),d("div",un,[t("div",{class:"admin-modal__backdrop",onClick:R}),t("div",rn,[t("div",mn,[n[35]||(n[35]=t("div",null,[t("p",{class:"admin-modal__eyebrow"},"숙소 승인"),t("h2",{class:"admin-modal__title"},"숙소를 승인할까요?")],-1)),t("button",{class:"admin-btn admin-btn--ghost",type:"button",disabled:i.value,onClick:R},"닫기",8,vn)]),t("div",cn,[t("div",null,[n[36]||(n[36]=t("span",null,"숙소 ID",-1)),t("strong",null,"#"+l(v.value?.accommodationsId??"-"),1)]),t("div",null,[n[37]||(n[37]=t("span",null,"숙소명",-1)),t("strong",null,l(v.value?.name??"-"),1)]),t("div",null,[n[38]||(n[38]=t("span",null,"호스트",-1)),t("strong",null,l(v.value?.hostUserId??"-"),1)])]),m.value?(u(),d("div",pn,l(m.value),1)):b("",!0),t("div",bn,[t("button",{class:"admin-btn admin-btn--ghost",type:"button",disabled:i.value,onClick:R},"취소",8,yn),t("button",{class:"admin-btn admin-btn--primary",type:"button",disabled:i.value,onClick:at},l(i.value?"처리 중...":"승인"),9,gn)])])])):b("",!0),P.value?(u(),d("div",fn,[t("div",{class:"admin-modal__backdrop",onClick:S}),t("div",_n,[t("div",kn,[n[39]||(n[39]=t("div",null,[t("p",{class:"admin-modal__eyebrow"},"숙소 반려"),t("h2",{class:"admin-modal__title"},"반려 사유를 입력해주세요")],-1)),t("button",{class:"admin-btn admin-btn--ghost",type:"button",disabled:i.value,onClick:S},"닫기",8,Cn)]),t("div",hn,[t("div",null,[n[40]||(n[40]=t("span",null,"숙소 ID",-1)),t("strong",null,"#"+l(v.value?.accommodationsId??"-"),1)]),t("div",null,[n[41]||(n[41]=t("span",null,"숙소명",-1)),t("strong",null,l(v.value?.name??"-"),1)])]),$(t("textarea",{"onUpdate:modelValue":n[6]||(n[6]=s=>h.value=s),class:"admin-input",rows:"3",placeholder:"예) 사진이 부족합니다. 시설 설명을 보완해주세요.",disabled:i.value},null,8,wn),[[X,h.value]]),m.value?(u(),d("div",In,l(m.value),1)):b("",!0),t("div",Rn,[t("button",{class:"admin-btn admin-btn--ghost",type:"button",disabled:i.value,onClick:S},"취소",8,Sn),t("button",{class:"admin-btn admin-btn--muted",type:"button",disabled:i.value,onClick:lt},l(i.value?"처리 중...":"반려"),9,An)])])])):b("",!0)]))}},Un=dt(Dn,[["__scopeId","data-v-c9c9b7a7"]]);export{Un as default};
