import{_ as W,r,q as A,y as F,c as t,e as s,d as h,z as L,C as k,E as I,t as v,N,F as Y,f as G,A as S,n as H,k as J,Y as K,Z as Q,$ as X,o as n}from"./index-B9EiY-js.js";const ee={class:"find-password-page"},se={class:"find-password-container"},le={key:0,class:"form-section"},oe={class:"input-group"},ae={class:"input-group"},te=["disabled"],ne={key:1,class:"form-section"},re={class:"input-group"},ie={class:"input-row"},ue={key:0,class:"timer"},de=["disabled"],ve=["disabled"],ce={key:2,class:"form-section"},pe={class:"input-group"},fe={class:"input-wrapper"},ge=["type"],we={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},me={key:1,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},he={class:"password-criteria"},ke={key:0,class:"check-icon",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},be={class:"criteria-label"},ye={class:"input-group"},_e={class:"input-wrapper"},Ce=["type"],xe={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},Me={key:1,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},Pe=["disabled"],Ve={key:3,class:"error-message"},Be={class:"modal-content"},$e={key:0},Ae={key:1},Ie={key:2},Se={class:"modal-message"},Te={__name:"FindPasswordView",setup(je){const T=J(),c=r(""),f=r(""),M=r(!1),P=r(!1),d=r(""),g=r(0);let b=null;const p=r(""),w=r(""),y=r(!1),_=r(!1),a=r(""),i=r(!1),V=r([{label:"영문",valid:!1,regex:/[a-zA-Z]/},{label:"숫자",valid:!1,regex:/[0-9]/},{label:"특수문자",valid:!1,regex:/[!@#$%^&*(),.?":{}|<>]/},{label:"8자 이상 20자 이하",valid:!1,regex:/^.{8,20}$/}]),j=A(()=>V.value.every(l=>l.valid)),m=A(()=>w.value?p.value===w.value?{valid:!0,message:"비밀번호가 일치합니다."}:{valid:!1,message:"비밀번호가 일치하지 않습니다."}:null);F(p,l=>{V.value.forEach(e=>{e.valid=e.regex.test(l)})}),F(f,l=>{let e=l.replace(/\D/g,""),o="";e.startsWith("010")&&e.length>3?e.length<8?o=e.substring(0,3)+"-"+e.substring(3):o=e.substring(0,3)+"-"+e.substring(3,7)+"-"+e.substring(7,11):e.length>0&&(o=e),o!==l&&(f.value=o)});const Z=A(()=>{const l=Math.floor(g.value/60),e=g.value%60;return`${l}:${e.toString().padStart(2,"0")}`}),z=()=>{B(),g.value=180,b=setInterval(()=>{g.value>0?g.value--:B()},1e3)},B=()=>{b&&(clearInterval(b),b=null)},E=async()=>{if(a.value="",!c.value||!f.value){a.value="이메일과 전화번호를 모두 입력해주세요.";return}i.value=!0;try{const l=await K({email:c.value,phone:f.value});l.ok?(M.value=!0,z(),u("인증번호가 발송되었습니다. 이메일을 확인해주세요.","success")):(a.value=l.data?.message||"사용자 정보를 찾을 수 없습니다.",u(a.value,"error"))}catch(l){console.error("비밀번호 찾기 요청 오류:",l),a.value="비밀번호 찾기 요청 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요.",u(a.value,"error")}finally{i.value=!1}},O=async()=>{if(console.log("========= handleVerifyCode 호출됨 ========="),console.log("email:",c.value),console.log("verificationCode:",d.value),a.value="",!d.value){a.value="인증번호를 입력해주세요.";return}if(d.value.length!==6){a.value="인증번호는 6자리입니다.";return}console.log("API 호출 직전..."),i.value=!0;try{console.log("verifyEmailCodeOnly 호출 시작");const l=await Q(c.value,d.value);console.log("========= API 응답 받음 ========="),console.log("인증번호 확인 응답:",l),console.log("response.ok:",l.ok),console.log("response.data:",l.data),console.log("response.data === true:",l.data===!0),l.ok&&l.data===!0?(console.log("인증 성공! isVerified를 true로 변경"),B(),P.value=!0,u("인증이 완료되었습니다. 새 비밀번호를 설정해주세요.","success")):(console.log("인증 실패 - response:",l),a.value="인증번호가 올바르지 않거나 만료되었습니다.",u(a.value,"error"))}catch(l){console.error("========= 인증번호 확인 오류 ========="),console.error("에러:",l),a.value="인증번호 확인 중 오류가 발생했습니다.",u(a.value,"error")}finally{i.value=!1,console.log("========= handleVerifyCode 종료 =========")}},R=async()=>{if(a.value="",!p.value||!w.value){a.value="새 비밀번호를 모두 입력해주세요.";return}if(p.value!==w.value){a.value="새 비밀번호가 일치하지 않습니다.";return}if(!j.value){a.value="비밀번호 정책을 확인해주세요.";return}i.value=!0;try{const l=await X({email:c.value,code:d.value,newPassword:p.value});l.ok?u("비밀번호가 성공적으로 변경되었습니다.","success",()=>{T.push("/login")}):(a.value=l.data?.message||"비밀번호 변경에 실패했습니다.",u(a.value,"error"))}catch(l){console.error("비밀번호 재설정 오류:",l),a.value="비밀번호 재설정 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요.",u(a.value,"error")}finally{i.value=!1}},$=r(!1),U=r(""),C=r("info"),x=r(null),u=(l,e="info",o=null)=>{U.value=l,C.value=e,x.value=o,$.value=!0},D=()=>{$.value=!1,x.value&&(x.value(),x.value=null)},q=()=>{T.back()};return(l,e)=>(n(),t("div",ee,[s("div",se,[s("div",{class:"page-header"},[s("button",{class:"back-btn",onClick:q},"←"),e[7]||(e[7]=s("h1",{class:"page-title"},"비밀번호 찾기",-1))]),M.value?M.value&&!P.value?(n(),t("div",ne,[e[12]||(e[12]=s("p",{class:"description"},"이메일로 전송된 인증번호를 입력해주세요.",-1)),s("div",re,[e[11]||(e[11]=s("label",{for:"verificationCode"},"인증번호",-1)),s("div",ie,[k(s("input",{type:"text",id:"verificationCode","onUpdate:modelValue":e[2]||(e[2]=o=>d.value=o),placeholder:"인증번호 6자리",maxlength:"6"},null,512),[[I,d.value]]),g.value>0?(n(),t("span",ue,v(Z.value),1)):h("",!0)])]),s("button",{class:"submit-btn",onClick:O,disabled:i.value||!d.value},v(i.value?"확인 중...":"인증 확인"),9,de),s("button",{class:"resend-btn",onClick:E,disabled:i.value}," 인증 코드 재전송 ",8,ve)])):P.value?(n(),t("div",ce,[e[20]||(e[20]=s("p",{class:"description"},"새로운 비밀번호를 설정해주세요.",-1)),s("div",pe,[e[16]||(e[16]=s("label",{for:"newPassword"},"새 비밀번호",-1)),s("div",fe,[k(s("input",{type:y.value?"text":"password",id:"newPassword","onUpdate:modelValue":e[3]||(e[3]=o=>p.value=o),placeholder:"새 비밀번호를 입력하세요"},null,8,ge),[[N,p.value]]),s("button",{type:"button",class:"toggle-btn",onClick:e[4]||(e[4]=o=>y.value=!y.value)},[y.value?(n(),t("svg",we,[...e[13]||(e[13]=[s("path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"},null,-1),s("circle",{cx:"12",cy:"12",r:"3"},null,-1)])])):(n(),t("svg",me,[...e[14]||(e[14]=[s("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-10-7-10-7a13.16 13.16 0 0 1 1.67-2.68L4 11"},null,-1),s("path",{d:"M12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68M17.94 17.94 4 4"},null,-1)])]))])]),s("div",he,[(n(!0),t(Y,null,G(V.value,o=>(n(),t("span",{key:o.label,class:S({"is-valid":o.valid})},[o.valid?(n(),t("svg",ke,[...e[15]||(e[15]=[s("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):h("",!0),s("span",be,v(o.label),1)],2))),128))])]),s("div",ye,[e[19]||(e[19]=s("label",{for:"newPasswordConfirm"},"새 비밀번호 확인",-1)),s("div",_e,[k(s("input",{type:_.value?"text":"password",id:"newPasswordConfirm","onUpdate:modelValue":e[5]||(e[5]=o=>w.value=o),placeholder:"새 비밀번호를 다시 입력하세요"},null,8,Ce),[[N,w.value]]),s("button",{type:"button",class:"toggle-btn",onClick:e[6]||(e[6]=o=>_.value=!_.value)},[_.value?(n(),t("svg",xe,[...e[17]||(e[17]=[s("path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"},null,-1),s("circle",{cx:"12",cy:"12",r:"3"},null,-1)])])):(n(),t("svg",Me,[...e[18]||(e[18]=[s("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-10-7-10-7a13.16 13.16 0 0 1 1.67-2.68L4 11"},null,-1),s("path",{d:"M12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68M17.94 17.94 4 4"},null,-1)])]))])]),m.value?(n(),t("span",{key:0,class:S(["email-check-message",{"success-match":m.value.valid,error:!m.value.valid}])},v(m.value.message),3)):h("",!0)]),s("button",{class:"submit-btn",onClick:R,disabled:i.value||!j.value||m.value&&!m.value.valid},v(i.value?"변경 중...":"비밀번호 변경"),9,Pe)])):h("",!0):(n(),t("div",le,[e[10]||(e[10]=s("p",{class:"description"},[L("회원가입 시 입력했던"),s("br"),L("이메일과 전화번호를 입력해주세요.")],-1)),s("div",oe,[e[8]||(e[8]=s("label",{for:"email"},"이메일",-1)),k(s("input",{type:"email",id:"email","onUpdate:modelValue":e[0]||(e[0]=o=>c.value=o),placeholder:"example@email.com"},null,512),[[I,c.value]])]),s("div",ae,[e[9]||(e[9]=s("label",{for:"phone"},"전화번호",-1)),k(s("input",{type:"tel",id:"phone","onUpdate:modelValue":e[1]||(e[1]=o=>f.value=o),placeholder:"010-1234-5678"},null,512),[[I,f.value]])]),s("button",{class:"submit-btn",onClick:E,disabled:i.value},v(i.value?"전송 중...":"인증 코드 전송"),9,te)])),a.value?(n(),t("p",Ve,v(a.value),1)):h("",!0)]),$.value?(n(),t("div",{key:0,class:"modal-overlay",onClick:H(D,["self"])},[s("div",Be,[s("div",{class:S(["modal-icon",C.value])},[C.value==="success"?(n(),t("span",$e,"✓")):C.value==="error"?(n(),t("span",Ae,"!")):(n(),t("span",Ie,"i"))],2),s("p",Se,v(U.value),1),s("button",{class:"modal-btn",onClick:D},"확인")])])):h("",!0)]))}},Ue=W(Te,[["__scopeId","data-v-76e3eac3"]]);export{Ue as default};
