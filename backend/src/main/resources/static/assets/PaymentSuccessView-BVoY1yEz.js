import{J as P,_ as R,r as n,b as A,s as M,k as E,c as u,d as _,e as s,t as d,z as N,o as r}from"./index-Br9ce33d.js";async function V(m){const o=await P("/api/payments/confirm",{method:"POST",body:JSON.stringify(m)});if(!o.ok)throw new Error(o.data?.message||`ê²°ì œ ìŠ¹ì¸ ì‹¤íŒ¨: ${o.status}`);return o.data}const B={class:"payment-result-page"},O={key:0,class:"loading-container"},x={key:1,class:"success-container"},L={key:0,class:"payment-info"},D={class:"info-row"},q={class:"info-row"},H={key:2,class:"error-container"},J={class:"error-message"},U={key:3,class:"modal-overlay"},Y={class:"coupon-modal-content"},z={class:"coupon-modal-message"},F={__name:"PaymentSuccessView",setup(m){const o=E(),b=M(),p=n(!0),v=n(!1),i=n(""),a=n(null),y=n(null),c=n(!1),f=n(""),g=()=>{o.replace({name:"booking-success",state:{bookingData:{reservationId:y.value,paymentId:a.value?.payment?.paymentId,totalPrice:a.value?.payment?.approvedAmount}}})},I=()=>{c.value=!1,g()},T=()=>{c.value=!1,o.replace("/coupons")};A(async()=>{const{paymentKey:l,orderId:e,amount:k,reservationId:w}=b.query;if(y.value=w,!l||!e||!k){i.value="ê²°ì œ ì •ë³´ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.",p.value=!1,setTimeout(()=>o.replace("/"),3e3);return}try{const t=await V({paymentKey:l,orderId:e,amount:parseInt(k)});a.value=t,v.value=!0,t.couponIssued?(f.value=t.couponName||"ì²« ì˜ˆì•½ ê°ì‚¬ ì¿ í°",setTimeout(()=>{c.value=!0},1e3)):setTimeout(()=>g(),2e3)}catch(t){console.error("ê²°ì œ ìŠ¹ì¸ ì‹¤íŒ¨:",t),t.message?.includes("ì´ë¯¸")||t.message?.includes("ì¤‘ë³µ")?i.value="ì´ë¯¸ ì²˜ë¦¬ëœ ê²°ì œì…ë‹ˆë‹¤. ì˜ˆì•½ ë‚´ì—­ì„ í™•ì¸í•´ì£¼ì„¸ìš”.":i.value=t.message||"ê²°ì œ ìŠ¹ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",setTimeout(()=>o.replace("/"),3e3)}finally{p.value=!1}});const C=l=>({ì¹´ë“œ:"ì‹ ìš©/ì²´í¬ì¹´ë“œ",CARD:"ì‹ ìš©/ì²´í¬ì¹´ë“œ",ê°€ìƒê³„ì¢Œ:"ê°€ìƒê³„ì¢Œ",VIRTUAL_ACCOUNT:"ê°€ìƒê³„ì¢Œ",ê³„ì¢Œì´ì²´:"ê³„ì¢Œì´ì²´",TRANSFER:"ê³„ì¢Œì´ì²´",íœ´ëŒ€í°:"íœ´ëŒ€í° ê²°ì œ",MOBILE_PHONE:"íœ´ëŒ€í° ê²°ì œ",ê°„í¸ê²°ì œ:"ê°„í¸ê²°ì œ",EASY_PAY:"ê°„í¸ê²°ì œ",í† ìŠ¤í˜ì´:"í† ìŠ¤í˜ì´",í† ìŠ¤ê²°ì œ:"í† ìŠ¤í˜ì´"})[l]||l,S=()=>o.replace("/");return(l,e)=>(r(),u("div",B,[p.value?(r(),u("div",O,[...e[0]||(e[0]=[s("div",{class:"spinner"},null,-1),s("p",null,"ê²°ì œë¥¼ í™•ì¸í•˜ê³  ìˆìŠµë‹ˆë‹¤...",-1)])])):v.value?(r(),u("div",x,[e[3]||(e[3]=s("div",{class:"check-icon"},"âœ“",-1)),e[4]||(e[4]=s("h1",null,"ê²°ì œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!",-1)),e[5]||(e[5]=s("p",null,"ì ì‹œ í›„ ì˜ˆì•½ ì™„ë£Œ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤...",-1)),a.value?.payment?(r(),u("div",L,[s("div",D,[e[1]||(e[1]=s("span",null,"ê²°ì œ ê¸ˆì•¡",-1)),s("span",null,"â‚©"+d(a.value.payment.approvedAmount?.toLocaleString()),1)]),s("div",q,[e[2]||(e[2]=s("span",null,"ê²°ì œ ìˆ˜ë‹¨",-1)),s("span",null,d(C(a.value.payment.paymentMethod)),1)])])):_("",!0)])):(r(),u("div",H,[e[6]||(e[6]=s("div",{class:"error-icon"},"âœ•",-1)),e[7]||(e[7]=s("h1",null,"ê²°ì œ ìŠ¹ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤",-1)),s("p",J,d(i.value),1),s("button",{class:"btn",onClick:S},"í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°")])),c.value?(r(),u("div",U,[s("div",Y,[s("button",{class:"coupon-modal-close",onClick:I},"Ã—"),e[10]||(e[10]=s("div",{class:"coupon-modal-icon"},[s("span",null,"ğŸ‰")],-1)),e[11]||(e[11]=s("h2",{class:"coupon-modal-title"},"ì¿ í°ì´ ë°œê¸‰ë˜ì—ˆìŠµë‹ˆë‹¤!",-1)),s("p",z,[N(d(f.value)+"ì´(ê°€) ë°œê¸‰ë˜ì—ˆìŠµë‹ˆë‹¤.",1),e[8]||(e[8]=s("br",null,null,-1)),e[9]||(e[9]=N("ì¿ í°í•¨ì„ í™•ì¸í•´ì£¼ì„¸ìš”!",-1))]),s("button",{class:"coupon-modal-btn",onClick:T},"ì¿ í°í•¨ìœ¼ë¡œ ê°€ê¸°")])])):_("",!0)]))}},$=R(F,[["__scopeId","data-v-26fadb3d"]]);export{$ as default};
