import{_ as V,r as o,b as q,s as O,q as D,y as T,c as m,e,m as C,d as A,F as E,f as I,t as d,C as L,E as B,I as M,H as z,k as H,o as u,l as N}from"./index-_lApdx98.js";import{A as P}from"./AdminStatCard-DrnGDQ-7.js";import{A as Q}from"./AdminBadge-Erkuo2MI.js";import{A as X}from"./AdminTableCard-BQK8CT4-.js";import{e as F,a as j}from"./reportExport-BKny35g8.js";import{e as G}from"./adminApi-Blw4lhJ8.js";import{e as J,a as K,t as U}from"./adminData-ZmZ3C3cR.js";const W={class:"admin-page"},Y={class:"admin-grid"},Z={key:0,class:"admin-status"},ee={key:1,class:"admin-status"},te={class:"admin-filter-bar"},le={class:"admin-filter-group"},ae={class:"admin-filter-group"},se={class:"admin-filter-group"},ne={class:"admin-dropdown"},oe={class:"admin-dropdown__menu"},ie={class:"admin-table--nowrap admin-table--tight admin-table--stretch"},de={class:"admin-strong"},ue=["title"],re={class:"admin-align-center"},me={class:"admin-align-center"},ce={key:0,class:"admin-status"},ve={class:"admin-pagination"},pe=["disabled"],be=["disabled"],ye={__name:"AdminUsersView",setup(ge){const f=o([]),y=o([]),r=o(""),n=o("all"),s=o(0),k=o(20),h=o(0),w=o(0),g=o(!1),v=o(""),p=O(),$=H(),b=async()=>{g.value=!0,v.value="";const a=await G({role:n.value==="all"?void 0:n.value,keyword:r.value||void 0,page:s.value,size:k.value,sort:"latest"});if(a.ok&&a.data){const t=a.data;y.value=J(t);const l=K(t);s.value=l.page,k.value=l.size,h.value=l.totalPages,w.value=l.totalElements;const c=y.value.filter(i=>i.role==="HOST"||i.role==="ROLE_HOST").length,S=y.value.filter(i=>i.role==="USER"||i.role==="ROLE_USER").length;f.value=[{label:"전체 사용자",value:`${w.value}명`,sub:"전체 계정 기준",tone:"primary"},{label:"게스트",value:`${S}명`,sub:"현재 페이지 기준",tone:"success"},{label:"호스트",value:`${c}명`,sub:"현재 페이지 기준",tone:"accent"}]}else v.value="회원 목록을 불러오지 못했습니다.";g.value=!1},R=a=>{const t={...p.query,...a},l=U(t),c=U(p.query);Object.keys({...l,...c}).every(i=>String(l[i]??"")===String(c[i]??""))||$.replace({query:l})};q(()=>{n.value=p.query.role??"all",r.value=p.query.keyword??"",s.value=Number(p.query.page??0),b()});const _=D(()=>{const a=r.value.trim().toLowerCase();return y.value.filter(t=>{const l=!a||String(t.userId??"").includes(a)||(t.email??"").toLowerCase().includes(a)||(t.phone??"").includes(a),c=n.value==="all"||t.role===n.value||t.role===`ROLE_${n.value}`;return l&&c})});T([r,n],()=>{s.value=0,R({role:n.value,keyword:r.value||void 0,page:s.value}),b()});const x=a=>{const t=new Date().toISOString().slice(0,10),l=[{name:"회원 목록",columns:[{key:"id",label:"ID"},{key:"name",label:"이름"},{key:"email",label:"이메일"},{key:"phone",label:"연락처"},{key:"type",label:"유형"},{key:"joinedAt",label:"가입일"},{key:"lastLogin",label:"최근 접속"},{key:"activity",label:"활동"},{key:"risk",label:"리스크"},{key:"status",label:"상태"}],rows:_.value}];if(a==="xlsx"){F({filename:`admin-users-${t}.xlsx`,sheets:l});return}j({filename:`admin-users-${t}.csv`,sheets:l})};return(a,t)=>(u(),m("section",W,[t[12]||(t[12]=e("header",{class:"admin-page__header"},[e("div",null,[e("h1",{class:"admin-title"},"회원 관리"),e("p",{class:"admin-subtitle"},"게스트/호스트 현황과 상태를 확인합니다.")])],-1)),e("div",Y,[(u(!0),m(E,null,I(f.value,l=>(u(),N(P,{key:l.label,label:l.label,value:l.value,sub:l.sub,tone:l.tone},null,8,["label","value","sub","tone"]))),128)),g.value?(u(),m("div",Z,"불러오는 중...")):v.value?(u(),m("div",ee,[e("span",null,d(v.value),1),e("button",{class:"admin-btn admin-btn--ghost",type:"button",onClick:b},"다시 시도")])):A("",!0)]),e("div",te,[e("div",le,[t[6]||(t[6]=e("span",{class:"admin-chip"},"검색",-1)),L(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>r.value=l),class:"admin-input",type:"search",placeholder:"이름, 이메일, 연락처, ID"},null,512),[[B,r.value]])]),e("div",ae,[t[8]||(t[8]=e("span",{class:"admin-chip"},"필터",-1)),L(e("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>n.value=l),class:"admin-select"},[...t[7]||(t[7]=[e("option",{value:"all"},"전체 유형",-1),e("option",{value:"USER"},"게스트",-1),e("option",{value:"HOST"},"호스트",-1)])],512),[[M,n.value]])]),e("div",se,[e("details",ne,[t[9]||(t[9]=e("summary",{class:"admin-btn admin-btn--ghost"},"다운로드",-1)),e("div",oe,[e("button",{class:"admin-btn admin-btn--ghost admin-dropdown__item",type:"button",onClick:t[2]||(t[2]=l=>x("csv"))}," CSV "),e("button",{class:"admin-btn admin-btn--primary admin-dropdown__item",type:"button",onClick:t[3]||(t[3]=l=>x("xlsx"))}," XLSX ")])])])]),C(X,{title:"회원 목록"},{default:z(()=>[e("table",ie,[t[10]||(t[10]=e("colgroup",null,[e("col",{style:{width:"90px"}}),e("col",{style:{width:"320px"}}),e("col",{style:{width:"160px"}}),e("col",{style:{width:"110px"}}),e("col",{style:{width:"140px"}}),e("col",{style:{width:"140px"}})],-1)),t[11]||(t[11]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"이메일"),e("th",null,"연락처"),e("th",null,"유형"),e("th",null,"가입일"),e("th",null,"호스트 승인")])],-1)),e("tbody",null,[(u(!0),m(E,null,I(_.value,l=>(u(),m("tr",{key:l.userId},[e("td",de,"#"+d(l.userId),1),e("td",{class:"admin-strong admin-ellipsis",title:l.email},d(l.email),9,ue),e("td",null,d(l.phone),1),e("td",re,d(l.role),1),e("td",me,d(l.createdAt?.slice?.(0,10)??"-"),1),e("td",null,[C(Q,{text:l.hostApproved?"승인":"미승인",variant:l.hostApproved?"success":"warning"},null,8,["text","variant"])])]))),128))])]),!g.value&&!v.value&&!_.value.length?(u(),m("div",ce,"데이터가 없습니다.")):A("",!0),e("div",ve,[e("button",{class:"admin-btn admin-btn--ghost",type:"button",disabled:s.value<=0,onClick:t[4]||(t[4]=l=>{s.value=s.value-1,b()})}," 이전 ",8,pe),e("span",null,d(s.value+1)+" / "+d(Math.max(h.value,1)),1),e("button",{class:"admin-btn admin-btn--ghost",type:"button",disabled:s.value+1>=h.value,onClick:t[5]||(t[5]=l=>{s.value=s.value+1,b()})}," 다음 ",8,be)])]),_:1})]))}},Ce=V(ye,[["__scopeId","data-v-837c7ab2"]]);export{Ce as default};
