import{h as ne,a5 as ot,_ as nt,r as i,a6 as it,q as d,b as rt,a4 as Me,k as ut,a0 as He,a3 as dt,y as oe,c as o,l as ct,F as c,e,d as x,t as n,f as v,z as k,C as w,H as G,A as y,E,a as vt,o as l,D as mt,p as pt}from"./index-B9EiY-js.js";import{f as ht}from"./hostAccommodation-CmFjMFT9.js";import{d as ft,b as yt}from"./useHostState-C50sIYyu.js";import{H as gt}from"./HostGateNotice-C9N0CzM7.js";import{a as _t}from"./formatters-De2UUEom.js";const ie=(b={})=>{const O={};return Object.entries(b).forEach(([N,D])=>{if(D!=null){if(typeof D=="string"){const $=D.trim();if(!$)return;O[N]=$;return}O[N]=D}}),O};async function bt(b={}){return ne("/host/reports/reviews/summary",ie(b))}async function kt(b={}){return ne("/host/reports/reviews/trend",ie(b))}async function It(b={}){return ne("/host/reports/themes/popular",ie(b))}async function xt(b={}){return ne("/host/reports/forecast/demand",ie(b))}async function wt(b={}){return ot("/host/reports/reviews/ai-summary",{method:"POST",body:JSON.stringify(b)})}const $t={key:0,class:"report-view"},Ct={class:"host-view-header"},Nt={key:0,class:"host-subtitle"},St={key:1,class:"error-text"},Rt={class:"context-bar"},Dt={class:"context-text"},At={class:"context-chips"},Vt={key:0,class:"tag-chip"},Tt={class:"tag-chip"},Mt={class:"report-tabs",role:"tablist"},Ht=["onClick"],Ft={key:0,class:"report-section"},Pt={class:"filter-card"},Ut={class:"filters filters-grid"},Lt=["value"],Et={class:"filter-group"},Ot={key:0,class:"loading-box"},zt={key:1,class:"error-box"},Yt={key:2},Gt={class:"kpi-grid"},jt={class:"kpi-card"},Bt={class:"kpi-card"},Kt={class:"kpi-card"},Xt={key:0,class:"empty-box"},qt={key:1,class:"grid-two"},Wt={class:"panel"},Zt={class:"rating-bars"},Jt={class:"rating-label"},Qt={class:"rating-bar"},es={class:"rating-count"},ts={class:"rating-percent"},ss={class:"panel"},as={class:"tag-list"},ls={key:0,class:"muted"},os={class:"panel ai-panel"},ns={class:"ai-head"},is={class:"ai-meta"},rs=["disabled","aria-busy"],us={key:0,class:"spinner","aria-hidden":"true"},ds={class:"ai-meta-chips"},cs={key:0,class:"error-box ai-state"},vs={key:1,class:"empty-box ai-state"},ms={key:2,class:"ai-grid"},ps={class:"ai-block"},hs={class:"ai-block"},fs={class:"ai-block"},ys={class:"ai-block"},gs={class:"ai-block ai-wide"},_s={key:3,class:"muted ai-state"},bs={class:"panel"},ks={key:0,class:"muted"},Is={key:1,class:"review-cards"},xs={class:"review-head"},ws={class:"review-meta"},$s={class:"review-date"},Cs=["onClick"],Ns={key:2,class:"panel"},Ss={class:"simple-table table-only"},Rs={class:"card-list mobile-only"},Ds={class:"report-card__row"},As={class:"muted"},Vs={key:1,class:"report-section"},Ts={class:"theme-section-wrap"},Ms={class:"theme-layout"},Hs={class:"filter-card theme-filter"},Fs={class:"filters filters-grid"},Ps=["value"],Us={class:"filter-group"},Ls={class:"theme-content"},Es={class:"theme-kpi-grid"},Os={class:"theme-results-card"},zs={class:"theme-results-head"},Ys={class:"theme-view-toggle",role:"tablist","aria-label":"보기 전환"},Gs=["aria-selected"],js=["aria-selected"],Bs={class:"theme-results-body"},Ks={key:0,class:"loading-box"},Xs={key:1,class:"error-box"},qs={key:2},Ws={key:0,class:"empty-box"},Zs={key:1},Js={key:0,class:"theme-grid-desktop"},Qs={class:"theme-card__head"},ea={class:"theme-card__metrics"},ta={class:"theme-metric"},sa={class:"theme-metric"},aa={class:"theme-metric"},la={key:1,class:"theme-table-wrapper"},oa={class:"simple-table theme-table"},na={class:"cell-right"},ia={class:"cell-right"},ra={class:"cell-right"},ua={key:2,class:"theme-grid theme-grid-stack"},da={class:"theme-card__head"},ca={class:"theme-card__metrics"},va={class:"theme-metric"},ma={class:"theme-metric"},pa={class:"theme-metric"},ha={key:2,class:"report-section"},fa={class:"filter-card"},ya={class:"filters filters-grid"},ga=["value"],_a={key:0,class:"loading-box"},ba={key:1,class:"error-box"},ka={key:2},Ia={class:"kpi-grid"},xa={class:"kpi-card"},wa={class:"kpi-card"},$a={class:"kpi-card"},Ca={key:0,class:"forecast-meta"},Na={key:1,class:"empty-box"},Sa={key:2},Ra={key:0,class:"forecast-toolbar"},Da={class:"forecast-view-toggle",role:"tablist","aria-label":"예측 보기 전환"},Aa=["aria-selected"],Va=["aria-selected"],Ta={key:1,class:"forecast-table-wrap"},Ma={key:0,class:"forecast-chart"},Ha={class:"forecast-chart__canvas",viewBox:"0 0 1000 200",role:"img","aria-label":"수요 예측 차트",preserveAspectRatio:"none"},Fa=["d"],Pa=["points"],Ua={class:"forecast-chart__points"},La=["cx","cy"],Ea={class:"forecast-chart__axis"},Oa={key:1,class:"empty-box"},za={class:"simple-table forecast-table"},Ya={class:"cell-right"},Ga={class:"cell-right"},ja={class:"cell-right"},Ba={class:"cell-right"},Ka={key:2,class:"card-list forecast-cards"},Xa={class:"report-card__row"},qa={class:"muted forecast-card-meta"},Wa={class:"muted forecast-card-range"},Za={key:1,class:"report-view"},Ja={__name:"HostReportView",setup(b){const O=[{id:"reviews",label:"리뷰 리포트"},{id:"themes",label:"테마 인기"},{id:"forecast",label:"수요 예측"}],N=i("reviews"),D=ut(),$=i(it()),ke=i(!1),Fe=d(()=>$.value?$.value.role==="HOST"||$.value.role==="ROLE_HOST"||$.value.hostApproved===!0:!1),z=i([]),re=i(!1),j=i(""),B=()=>new Date().toISOString().slice(0,10),ue=a=>{const t=new Date;return t.setDate(t.getDate()-a),t.toISOString().slice(0,10)},Ie=ue(30),xe=B(),r=i({accommodationId:"all",from:Ie,to:xe}),K=i("30days"),X=i("30days"),g=i(null),Y=i([]),q=i(!1),W=i(""),h=i(null),S=i(!1),H=i(""),Z=i({}),m=a=>{const t=Number(a);return Number.isFinite(t)?new Intl.NumberFormat("ko-KR").format(t):"0"},Pe=a=>`${m(a)}원`,Ue=a=>{if(!a)return"-";const t=String(a).replace(/\[[^\]]+]/g,"").replace(/(\.\d{3})\d+/g,"$1").trim(),s=new Date(t);if(Number.isNaN(s.getTime()))return"-";const u=I=>String(I).padStart(2,"0");return`${s.getFullYear()}.${u(s.getMonth()+1)}.${u(s.getDate())} ${u(s.getHours())}:${u(s.getMinutes())}`},we=d(()=>h.value?["overview","positives","negatives","actions","risks"].some(t=>Array.isArray(h.value?.[t])&&h.value[t].length>0):!1),f=i({accommodationId:"all",from:Ie,to:xe,metric:"reservations"}),de=i(!1),J=i(""),$e=i(null),p=i({accommodationId:"all",target:"reservations",horizonDays:30,historyDays:180}),ce=i(!1),Q=i(""),A=i(null),C=i("table"),ee=i(!1),ve=d(()=>ft(z.value)),te=d(()=>ve.value.gateState==="APPROVED"),Le=d(()=>!te.value&&ve.value.hostState!=="loading"),V=d(()=>yt(ve.value)),Ee=d(()=>{const a=g.value?.ratingDistribution||{},t=(g.value?.reviewCount??0)||0;return[5,4,3,2,1].map(s=>{const u=a[s]??0,I=t>0?Math.round(u/t*100):0;return{rating:s,count:u,percent:I}})}),me=d(()=>(g.value?.reviewCount??0)>0),Oe=d(()=>me.value&&!q.value&&!S.value),ze=d(()=>{const a=[];r.value.from&&r.value.to&&a.push(`기간 ${r.value.from} ~ ${r.value.to}`);const t=m(g.value?.reviewCount??0);return a.push(`리뷰 ${t}건 기준`),h.value?.generatedAt&&a.push(`생성 ${Ue(h.value.generatedAt)}`),a}),Ye=d(()=>{const a=Array.isArray(h.value?.negatives)?[...h.value.negatives]:[],t=g.value?.ratingDistribution??{},s=[1,2,3].reduce((I,ae)=>I+Number(t?.[ae]??0),0),u=[];return s>0?u.push("낮은 평점(3점 이하) 리뷰가 있습니다. 원인 태그를 점검하세요."):u.push("부정 신호가 적습니다(유지관리 권장)."),u.push("반복 키워드/불만 흐름을 주간으로 모니터링하세요."),u.push("청소·소음·응대 체크리스트를 정기 점검하세요."),u.push("체크인 안내/응대 속도에 대한 피드백을 점검하세요."),u.forEach(I=>{a.length<3&&!a.includes(I)&&a.push(I)}),a.slice(0,3)}),R=d(()=>$e.value?.rows??[]),Ce=d(()=>R.value.reduce((a,t)=>(a.reservations+=Number(t.reservationCount??0),a.revenue+=Number(t.revenueSum??0),a),{reservations:0,revenue:0})),Ge=d(()=>{if(R.value.length===0)return null;const a=f.value.metric==="revenue"?"revenueSum":"reservationCount";return R.value.reduce((t,s)=>{const u=Number(s[a]??0);return t?u>Number(t[a]??0)?s:t:s},null)}),je=d(()=>[{label:"기간 예약수",value:`${m(Ce.value.reservations)}건`},{label:"기간 매출",value:`${m(Ce.value.revenue)}원`},{label:"Top 테마",value:Ge.value?.themeName??"데이터 없음"}]),T=i("cards"),pe=a=>Number(a??0)===0,se=d(()=>A.value?.forecastDaily??[]),F=d(()=>{const a=g.value?.topTags??[];return a.length>0?`${a[0].tagName}`:"데이터 없음"}),P=a=>p.value.target==="revenue"?Pe(a):`${m(a)}건`,Be=d(()=>p.value.target==="revenue"?"예측 매출(원)":"예측 예약(건)"),Ke=d(()=>p.value.target==="revenue"?"예측 범위(원)":"예측 범위(건)"),Ne=d(()=>{const a=A.value?.explain,t=A.value?.diagnostics?.mape,s=[];return a&&s.push(a),Number.isFinite(t)&&s.push(`백테스트 MAPE ${m(t)}%`),s.join(" · ")}),he=a=>{if(!a||!a.low&&!a.high||Number(a.low)===0&&Number(a.high)===0)return"-";const t=m(a.low??0),s=m(a.high??0);return`${t} ~ ${s}`},Xe=a=>{if(!a)return"";const t=String(a),s=t.split("-");return s.length!==3?t:`${s[1]}-${s[2]}`},U=d(()=>se.value.map(a=>({date:a.date,label:Xe(a.date),predicted:Number(a.predictedValue??0),low:Number(a.low??0),high:Number(a.high??0)}))),L=d(()=>{const a=U.value;if(!a.length)return null;const t=1e3,s=200,u=30,I=20,ae=Math.min(...a.map(_=>_.low??_.predicted)),Te=Math.max(...a.map(_=>_.high??_.predicted)),le=Number.isFinite(ae)?ae:0,ge=Number.isFinite(Te)?Te:0,Qe=ge-le||1,et=a.length>1?(t-u*2)/(a.length-1):0,_e=_=>u+et*_,be=_=>{const M=Math.max(le,Math.min(ge,_));return s-I-(M-le)/Qe*(s-I*2)},tt=a.map((_,M)=>`${_e(M)},${be(_.predicted)}`).join(" "),st=a.map((_,M)=>`${_e(M)},${be(_.high)}`).join(" "),at=a.map((_,M)=>`${_e(M)},${be(_.low)}`).reverse().join(" "),lt=`M ${st} L ${at} Z`;return{width:t,height:s,linePoints:tt,areaPath:lt,minY:le,maxY:ge}}),qe=d(()=>{const a=m(g.value?.reviewCount??0),t=g.value?.avgRating??0,s=F.value&&F.value!=="데이터 없음"?` · 대표태그 ${F.value}`:"";return`기간 ${r.value.from} ~ ${r.value.to} · 리뷰 ${a} · 평점 ${t}${s}`}),We=a=>{if(a==="7days")return{from:ue(7),to:B()};if(a==="30days")return{from:ue(30),to:B()};const t=new Date;return{from:new Date(t.getFullYear(),t.getMonth(),1).toISOString().slice(0,10),to:B()}},Se=(a,t)=>{const s=We(t);a.value={...a.value,...s}},fe=a=>{K.value=a,Se(r,a)},ye=a=>{X.value=a,Se(f,a)},Ze=async()=>{re.value=!0,j.value="";const a=await ht();if(a.ok){const t=a.data;z.value=Array.isArray(t)?t:t?.items??t?.content??t?.data??[]}else j.value="숙소 목록을 불러오지 못했습니다.";re.value=!1},Re=async()=>{if(!te.value)return;q.value=!0,W.value="";const a={from:r.value.from,to:r.value.to};r.value.accommodationId!=="all"&&(a.accommodationId=r.value.accommodationId);const[t,s]=await Promise.all([bt(a),kt({accommodationId:a.accommodationId,months:6})]);t.ok?g.value=t.data:W.value="리뷰 리포트를 불러오지 못했습니다.",s.ok?Y.value=Array.isArray(s.data)?s.data:[]:Y.value=[],q.value=!1},Je=a=>{Z.value[a]=!Z.value[a]},De=async()=>{if(S.value)return;if(!me.value){H.value="리뷰가 없는 기간입니다. 기간을 바꿔 다시 시도해주세요.",h.value=null;return}S.value=!0,H.value="";const a={from:r.value.from,to:r.value.to};r.value.accommodationId!=="all"&&(a.accommodationId=r.value.accommodationId);const t=await wt(a);t.ok?h.value=t.data:(H.value="AI 요약을 불러오지 못했습니다.",h.value=null),S.value=!1},Ae=async()=>{if(!te.value)return;de.value=!0,J.value="";const a={from:f.value.from,to:f.value.to,metric:f.value.metric};f.value.accommodationId!=="all"&&(a.accommodationId=f.value.accommodationId);const t=await It(a);t.ok?$e.value=t.data:J.value="테마 리포트를 불러오지 못했습니다.",de.value=!1},Ve=async()=>{if(!te.value)return;ce.value=!0,Q.value="";const a={target:p.value.target,horizonDays:p.value.horizonDays,historyDays:p.value.historyDays};p.value.accommodationId!=="all"&&(a.accommodationId=p.value.accommodationId);const t=await xt(a);t.ok?A.value=t.data:Q.value="수요 예측을 불러오지 못했습니다.",ce.value=!1};return rt(async()=>{if($.value){if(!Fe.value&&dt()){const t=await Me();t.ok&&t.data&&(He(t.data),$.value=t.data)}}else{const t=await Me();if(!t.ok||!t.data){D.replace("/login");return}He(t.data),$.value=t.data}if(typeof window<"u"){const t=window.matchMedia("(min-width: 768px)"),s=()=>{ee.value=t.matches};s(),t.addEventListener?.("change",s),t.addListener?.(s)}const a=typeof window<"u"?window.localStorage.getItem("hostForecastViewMode"):null;(a==="table"||a==="cards")&&(C.value=a),ke.value=!0,await Ze(),Re(),Ae(),Ve()}),oe(C,a=>{typeof window<"u"&&window.localStorage.setItem("hostForecastViewMode",a)}),oe(r,()=>{N.value==="reviews"&&(Re(),h.value=null,H.value="")},{deep:!0}),oe(f,()=>{Ae()},{deep:!0}),oe(p,()=>{N.value==="forecast"&&Ve()},{deep:!0}),(a,t)=>ke.value?(l(),o("section",$t,[Le.value?(l(),ct(gt,{key:0,title:V.value.title,description:V.value.description,reason:V.value.reason,"primary-text":V.value.primaryText,"primary-to":V.value.primaryTo,"secondary-text":V.value.secondaryText,"secondary-to":V.value.secondaryTo},null,8,["title","description","reason","primary-text","primary-to","secondary-text","secondary-to"])):(l(),o(c,{key:1},[e("header",Ct,[t[21]||(t[21]=e("div",null,[e("h2",{class:"host-title"},"리포트"),e("p",{class:"host-subtitle"},"리뷰/테마/수요 흐름을 한눈에 확인하세요.")],-1)),re.value?(l(),o("p",Nt,"숙소 불러오는 중...")):j.value?(l(),o("p",St,n(j.value),1)):x("",!0)]),e("div",Rt,[e("p",Dt,n(qe.value),1),e("div",At,[F.value!=="데이터 없음"?(l(),o("span",Vt,"대표 태그: "+n(F.value),1)):x("",!0),e("span",Tt,"기간: "+n(r.value.from)+" ~ "+n(r.value.to),1)])]),e("div",Mt,[(l(),o(c,null,v(O,s=>e("button",{key:s.id,type:"button",class:y(["report-tab",{active:N.value===s.id}]),onClick:u=>N.value=s.id},n(s.label),11,Ht)),64))]),N.value==="reviews"?(l(),o("section",Ft,[e("div",Pt,[t[26]||(t[26]=e("div",{class:"filter-title"},"필터",-1)),e("div",Ut,[e("label",null,[t[23]||(t[23]=k(" 숙소 ",-1)),w(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>r.value.accommodationId=s)},[t[22]||(t[22]=e("option",{value:"all"},"전체 숙소",-1)),(l(!0),o(c,null,v(z.value,s=>(l(),o("option",{key:s.accommodationsId,value:s.accommodationsId},n(s.accommodationsName),9,Lt))),128))],512),[[G,r.value.accommodationId]])]),e("div",Et,[e("button",{type:"button",class:y({active:K.value==="7days"}),onClick:t[1]||(t[1]=s=>fe("7days"))},"7일",2),e("button",{type:"button",class:y({active:K.value==="30days"}),onClick:t[2]||(t[2]=s=>fe("30days"))},"30일",2),e("button",{type:"button",class:y({active:K.value==="thisMonth"}),onClick:t[3]||(t[3]=s=>fe("thisMonth"))},"이번달",2)]),e("label",null,[t[24]||(t[24]=k(" 시작일 ",-1)),w(e("input",{type:"date","onUpdate:modelValue":t[4]||(t[4]=s=>r.value.from=s)},null,512),[[E,r.value.from]])]),e("label",null,[t[25]||(t[25]=k(" 종료일 ",-1)),w(e("input",{type:"date","onUpdate:modelValue":t[5]||(t[5]=s=>r.value.to=s)},null,512),[[E,r.value.to]])])])]),q.value?(l(),o("div",Ot,"리뷰 리포트 로딩 중...")):W.value?(l(),o("div",zt,n(W.value),1)):(l(),o("div",Yt,[e("div",Gt,[e("div",jt,[t[28]||(t[28]=e("div",{class:"kpi-icon"},"★",-1)),e("div",null,[t[27]||(t[27]=e("p",null,"평균 평점",-1)),e("strong",null,n(g.value?.avgRating??0),1)])]),e("div",Bt,[t[30]||(t[30]=e("div",{class:"kpi-icon"},"✉",-1)),e("div",null,[t[29]||(t[29]=e("p",null,"리뷰 수",-1)),e("strong",null,n(g.value?.reviewCount??0),1)])]),e("div",Kt,[t[32]||(t[32]=e("div",{class:"kpi-icon"},"#",-1)),e("div",null,[t[31]||(t[31]=e("p",null,"대표 태그",-1)),e("strong",null,n(F.value),1)])])]),me.value?(l(),o("div",qt,[e("div",Wt,[t[33]||(t[33]=e("h3",null,"별점 분포",-1)),e("ul",Zt,[(l(!0),o(c,null,v(Ee.value,s=>(l(),o("li",{key:s.rating},[e("span",Jt,n(s.rating)+"점",1),e("div",Qt,[e("span",{class:"rating-fill",style:mt({width:s.percent+"%"})},null,4)]),e("span",es,n(m(s.count))+"건",1),e("span",ts,n(s.percent)+"%",1)]))),128))])]),e("div",ss,[t[34]||(t[34]=e("h3",null,"TOP 태그",-1)),t[35]||(t[35]=e("p",{class:"muted"},"자주 언급된 키워드를 모았어요.",-1)),e("div",as,[(g.value?.topTags??[]).length===0?(l(),o("span",ls,"태그 데이터가 없습니다.")):x("",!0),(l(!0),o(c,null,v(g.value?.topTags,s=>(l(),o("span",{key:s.tagName,class:"tag-chip"},n(s.tagName)+" · "+n(s.count),1))),128))])])])):(l(),o("div",Xt,"선택한 기간에 리뷰가 없습니다.")),e("div",os,[e("div",ns,[t[36]||(t[36]=e("div",null,[e("p",{class:"ai-kicker"},"AI 리뷰 인사이트"),e("h3",null,"요약 리포트"),e("p",{class:"muted"},"선택 기간 리뷰를 기반으로 핵심 포인트를 정리합니다.")],-1)),e("div",is,[e("button",{type:"button",class:"primary-btn ai-btn",disabled:!Oe.value||S.value,"aria-busy":S.value?"true":"false",onClick:De},[S.value?(l(),o("span",us)):x("",!0),k(" "+n(S.value?"생성 중...":we.value?"재생성":"AI 요약 생성"),1)],8,rs),e("div",ds,[(l(!0),o(c,null,v(ze.value,s=>(l(),o("span",{key:s,class:"ai-chip"},n(s),1))),128))])])]),H.value?(l(),o("div",cs,[e("p",null,n(H.value),1),e("button",{type:"button",class:"link-btn",onClick:De},"다시 시도")])):h.value&&!we.value?(l(),o("div",vs,"AI 요약 대상 리뷰가 없습니다.")):h.value?(l(),o("div",ms,[e("div",ps,[t[37]||(t[37]=e("h4",null,"총평",-1)),e("ul",null,[(l(!0),o(c,null,v(h.value.overview,s=>(l(),o("li",{key:s},n(s),1))),128))])]),e("div",hs,[t[38]||(t[38]=e("h4",null,"좋았던 점",-1)),e("ul",null,[(l(!0),o(c,null,v(h.value.positives,s=>(l(),o("li",{key:s},n(s),1))),128))])]),e("div",fs,[t[39]||(t[39]=e("h4",null,"개선 포인트",-1)),e("ul",null,[(l(!0),o(c,null,v(Ye.value,s=>(l(),o("li",{key:s},n(s),1))),128))])]),e("div",ys,[t[40]||(t[40]=e("h4",null,"다음 액션",-1)),e("ul",null,[(l(!0),o(c,null,v(h.value.actions,s=>(l(),o("li",{key:s},n(s),1))),128))])]),e("div",gs,[t[41]||(t[41]=e("h4",null,"주의/리스크",-1)),e("ul",null,[(l(!0),o(c,null,v(h.value.risks,s=>(l(),o("li",{key:s},n(s),1))),128))])])])):(l(),o("div",_s,"AI 요약을 생성해보세요."))]),e("div",bs,[t[42]||(t[42]=e("h3",null,"최근 리뷰",-1)),(g.value?.recentReviews??[]).length===0?(l(),o("div",ks,"리뷰가 없습니다.")):(l(),o("div",Is,[(l(!0),o(c,null,v(g.value?.recentReviews,s=>(l(),o("article",{key:s.reviewId,class:"review-card"},[e("div",xs,[e("div",null,[e("strong",null,n(s.accommodationName),1),e("p",ws,n(s.authorName)+" · "+n(s.rating)+"점",1)]),e("span",$s,n(pt(_t)(s.createdAt,!0)),1)]),e("p",{class:y(["review-content",{expanded:Z.value[s.reviewId]}])},n(s.content),3),s.content&&s.content.length>120?(l(),o("button",{key:0,type:"button",class:"link-btn",onClick:u=>Je(s.reviewId)},n(Z.value[s.reviewId]?"접기":"더보기"),9,Cs)):x("",!0)]))),128))]))]),Y.value.length?(l(),o("div",Ns,[t[44]||(t[44]=e("h3",null,"리뷰 추이",-1)),e("table",Ss,[t[43]||(t[43]=e("thead",null,[e("tr",null,[e("th",null,"월"),e("th",null,"리뷰수"),e("th",null,"평균 평점")])],-1)),e("tbody",null,[(l(!0),o(c,null,v(Y.value,s=>(l(),o("tr",{key:s.period},[e("td",null,n(s.period),1),e("td",null,n(m(s.reviewCount)),1),e("td",null,n(s.avgRating),1)]))),128))])]),e("div",Rs,[(l(!0),o(c,null,v(Y.value,s=>(l(),o("div",{key:s.period,class:"report-card"},[e("div",Ds,[e("strong",null,n(s.period),1),e("span",null,n(m(s.reviewCount))+"건",1)]),e("p",As,"평균 평점 "+n(s.avgRating),1)]))),128))])])):x("",!0)]))])):N.value==="themes"?(l(),o("section",Vs,[e("div",Ts,[e("div",Ms,[e("aside",Hs,[t[51]||(t[51]=e("div",{class:"filter-title"},"필터",-1)),e("div",Fs,[e("label",null,[t[46]||(t[46]=k(" 숙소 ",-1)),w(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>f.value.accommodationId=s)},[t[45]||(t[45]=e("option",{value:"all"},"전체 숙소",-1)),(l(!0),o(c,null,v(z.value,s=>(l(),o("option",{key:s.accommodationsId,value:s.accommodationsId},n(s.accommodationsName),9,Ps))),128))],512),[[G,f.value.accommodationId]])]),e("div",Us,[e("button",{type:"button",class:y({active:X.value==="7days"}),onClick:t[7]||(t[7]=s=>ye("7days"))},"7일",2),e("button",{type:"button",class:y({active:X.value==="30days"}),onClick:t[8]||(t[8]=s=>ye("30days"))},"30일",2),e("button",{type:"button",class:y({active:X.value==="thisMonth"}),onClick:t[9]||(t[9]=s=>ye("thisMonth"))},"이번달",2)]),e("label",null,[t[47]||(t[47]=k(" 시작일 ",-1)),w(e("input",{type:"date","onUpdate:modelValue":t[10]||(t[10]=s=>f.value.from=s)},null,512),[[E,f.value.from]])]),e("label",null,[t[48]||(t[48]=k(" 종료일 ",-1)),w(e("input",{type:"date","onUpdate:modelValue":t[11]||(t[11]=s=>f.value.to=s)},null,512),[[E,f.value.to]])]),e("label",null,[t[50]||(t[50]=k(" 지표 ",-1)),w(e("select",{"onUpdate:modelValue":t[12]||(t[12]=s=>f.value.metric=s)},[...t[49]||(t[49]=[e("option",{value:"reservations"},"예약수",-1),e("option",{value:"revenue"},"매출",-1)])],512),[[G,f.value.metric]])])])]),e("div",Ls,[e("div",Es,[(l(!0),o(c,null,v(je.value,s=>(l(),o("div",{key:s.label,class:"kpi-card"},[e("div",null,[e("p",null,n(s.label),1),e("strong",null,n(s.value),1)])]))),128))]),e("div",Os,[e("div",zs,[t[52]||(t[52]=e("div",null,[e("h4",null,"테마 인기 결과"),e("p",{class:"muted"},"선택 기간 기준으로 테마별 성과를 보여줍니다.")],-1)),e("div",Ys,[e("button",{type:"button",role:"tab","aria-selected":T.value==="cards",class:y({active:T.value==="cards"}),onClick:t[13]||(t[13]=s=>T.value="cards")},"카드",10,Gs),e("button",{type:"button",role:"tab","aria-selected":T.value==="table",class:y({active:T.value==="table"}),onClick:t[14]||(t[14]=s=>T.value="table")},"테이블",10,js)])]),e("div",Bs,[de.value?(l(),o("div",Ks,"테마 리포트 로딩 중...")):J.value?(l(),o("div",Xs,n(J.value),1)):(l(),o("div",qs,[R.value.length===0?(l(),o("div",Ws,"선택한 기간에 테마 데이터가 없습니다.")):(l(),o("div",Zs,[T.value==="cards"?(l(),o("div",Js,[(l(!0),o(c,null,v(R.value,s=>(l(),o("article",{key:s.themeId,class:"theme-card"},[e("div",Qs,[e("strong",null,n(s.themeName),1)]),e("div",ea,[e("div",ta,[t[53]||(t[53]=e("span",null,"예약",-1)),e("strong",null,n(m(s.reservationCount))+"건",1)]),e("div",sa,[t[54]||(t[54]=e("span",null,"매출",-1)),e("strong",null,n(m(s.revenueSum))+"원",1)]),e("div",aa,[t[55]||(t[55]=e("span",null,"숙소",-1)),e("strong",null,n(m(s.accommodationCount))+"개",1)])])]))),128))])):(l(),o("div",la,[e("table",oa,[t[56]||(t[56]=e("thead",null,[e("tr",null,[e("th",null,"테마"),e("th",{class:"cell-right"},"예약(건)"),e("th",{class:"cell-right"},"매출(원)"),e("th",{class:"cell-right"},"숙소(개)")])],-1)),e("tbody",null,[(l(!0),o(c,null,v(R.value,s=>(l(),o("tr",{key:s.themeId},[e("td",null,n(s.themeName),1),e("td",na,[e("span",{class:y({"zero-value":pe(s.reservationCount)})},n(m(s.reservationCount)),3)]),e("td",ia,[e("span",{class:y({"zero-value":pe(s.revenueSum)})},n(m(s.revenueSum)),3)]),e("td",ra,[e("span",{class:y({"zero-value":pe(s.accommodationCount)})},n(m(s.accommodationCount)),3)])]))),128))])])]))])),R.value.length?(l(),o("div",ua,[(l(!0),o(c,null,v(R.value,s=>(l(),o("article",{key:s.themeId,class:"theme-card"},[e("div",da,[e("strong",null,n(s.themeName),1)]),e("div",ca,[e("div",va,[t[57]||(t[57]=e("span",null,"예약",-1)),e("strong",null,n(m(s.reservationCount))+"건",1)]),e("div",ma,[t[58]||(t[58]=e("span",null,"매출",-1)),e("strong",null,n(m(s.revenueSum))+"원",1)]),e("div",pa,[t[59]||(t[59]=e("span",null,"숙소",-1)),e("strong",null,n(m(s.accommodationCount))+"개",1)])])]))),128))])):x("",!0)]))])])])])])])):(l(),o("section",ha,[e("div",fa,[t[66]||(t[66]=e("div",{class:"filter-title"},"필터",-1)),e("div",ya,[e("label",null,[t[61]||(t[61]=k(" 숙소 ",-1)),w(e("select",{"onUpdate:modelValue":t[15]||(t[15]=s=>p.value.accommodationId=s)},[t[60]||(t[60]=e("option",{value:"all"},"전체 숙소",-1)),(l(!0),o(c,null,v(z.value,s=>(l(),o("option",{key:s.accommodationsId,value:s.accommodationsId},n(s.accommodationsName),9,ga))),128))],512),[[G,p.value.accommodationId]])]),e("label",null,[t[63]||(t[63]=k(" 대상 ",-1)),w(e("select",{"onUpdate:modelValue":t[16]||(t[16]=s=>p.value.target=s)},[...t[62]||(t[62]=[e("option",{value:"reservations"},"예약수",-1),e("option",{value:"revenue"},"매출",-1)])],512),[[G,p.value.target]])]),e("label",null,[t[64]||(t[64]=k(" 예측 기간(일) ",-1)),w(e("input",{type:"number",min:"7",max:"60","onUpdate:modelValue":t[17]||(t[17]=s=>p.value.horizonDays=s)},null,512),[[E,p.value.horizonDays,void 0,{number:!0}]])]),e("label",null,[t[65]||(t[65]=k(" 과거 데이터(일) ",-1)),w(e("input",{type:"number",min:"30",max:"365","onUpdate:modelValue":t[18]||(t[18]=s=>p.value.historyDays=s)},null,512),[[E,p.value.historyDays,void 0,{number:!0}]])])])]),ce.value?(l(),o("div",_a,"수요 예측 계산 중...")):Q.value?(l(),o("div",ba,n(Q.value),1)):(l(),o("div",ka,[e("div",Ia,[e("div",xa,[e("p",null,"최근 7일 평균"+n(p.value.target==="revenue"?"(원/일)":"(건/일)"),1),e("strong",null,n(P(A.value?.baseline?.recentAvg7??0)),1)]),e("div",wa,[e("p",null,"최근 28일 평균"+n(p.value.target==="revenue"?"(원/일)":"(건/일)"),1),e("strong",null,n(P(A.value?.baseline?.recentAvg28??0)),1)]),e("div",$a,[t[67]||(t[67]=e("p",null,"예측 합계",-1)),e("strong",null,n(P(A.value?.forecastSummary?.predictedTotal??0)),1)])]),Ne.value?(l(),o("p",Ca,n(Ne.value),1)):x("",!0),se.value.length===0?(l(),o("div",Na,"예측 데이터가 없습니다.")):(l(),o("div",Sa,[ee.value?(l(),o("div",Ra,[e("div",Da,[e("button",{type:"button",role:"tab","aria-selected":C.value==="table",class:y({active:C.value==="table"}),onClick:t[19]||(t[19]=s=>C.value="table")},"테이블",10,Aa),e("button",{type:"button",role:"tab","aria-selected":C.value==="cards",class:y({active:C.value==="cards"}),onClick:t[20]||(t[20]=s=>C.value="cards")},"카드",10,Va)])])):x("",!0),ee.value&&C.value==="table"?(l(),o("div",Ta,[L.value?(l(),o("div",Ma,[t[68]||(t[68]=vt('<div class="forecast-chart__legend" data-v-5211cff0><span class="legend-item" data-v-5211cff0><span class="legend-dot" data-v-5211cff0></span>예측</span><span class="legend-item" data-v-5211cff0><span class="legend-band" data-v-5211cff0></span>범위</span></div>',1)),(l(),o("svg",Ha,[e("path",{class:"forecast-chart__band",d:L.value.areaPath},null,8,Fa),e("polyline",{class:"forecast-chart__line",points:L.value.linePoints},null,8,Pa),e("g",Ua,[(l(!0),o(c,null,v(U.value,(s,u)=>(l(),o("circle",{key:s.date,cx:30+940/Math.max(1,U.value.length-1)*u,cy:180-(s.predicted-L.value.minY)/(L.value.maxY-L.value.minY||1)*160,r:"3"},[e("title",null,n(s.date)+" · "+n(P(s.predicted))+" · "+n(he(s)),1)],8,La))),128))])])),e("div",Ea,[e("span",null,n(U.value[0]?.label),1),e("span",null,n(U.value[U.value.length-1]?.label),1)])])):(l(),o("div",Oa,"예측 데이터가 없습니다.")),e("table",za,[e("thead",null,[e("tr",null,[t[69]||(t[69]=e("th",null,"날짜",-1)),t[70]||(t[70]=e("th",null,"요일",-1)),e("th",Ya,n(Be.value),1),e("th",Ga,n(Ke.value),1)])]),e("tbody",null,[(l(!0),o(c,null,v(se.value,s=>(l(),o("tr",{key:s.date,class:y([{"forecast-weekend":s.isWeekend},{"forecast-holiday":s.isHoliday}])},[e("td",null,n(s.date),1),e("td",null,n(s.dowLabel),1),e("td",ja,n(P(s.predictedValue)),1),e("td",Ba,n(he(s)),1)],2))),128))])])])):x("",!0),!ee.value||C.value==="cards"?(l(),o("div",Ka,[(l(!0),o(c,null,v(se.value,s=>(l(),o("div",{key:s.date,class:"report-card"},[e("div",Xa,[e("strong",null,n(s.date),1),e("span",null,n(P(s.predictedValue)),1)]),e("p",qa,n(s.dowLabel)+n(s.isHoliday?" · 공휴일":s.isWeekend?" · 주말":""),1),e("p",Wa,"예측 범위 "+n(he(s)),1)]))),128))])):x("",!0)]))]))]))],64))])):(l(),o("section",Za,[...t[71]||(t[71]=[e("div",{class:"loading-box"},"권한을 확인하는 중입니다...",-1)])]))}},ll=nt(Ja,[["__scopeId","data-v-5211cff0"]]);export{ll as default};
