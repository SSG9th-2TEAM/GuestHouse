const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-B9EiY-js.js","assets/index-CMHUjmj9.css"])))=>i.map(i=>d[i]);
import{_ as k,r as m,b as R,j as I,a0 as _,k as T,c as i,e as s,t as y,o as c}from"./index-B9EiY-js.js";const S={class:"oauth2-redirect-page"},w={class:"redirect-container"},U={key:0,class:"loading-state"},b={key:1,class:"error-state"},E={key:2,class:"success-state"},L={__name:"OAuth2RedirectHandler",setup(O){const p=T(),g=m(!0),l=m(null),v=t=>{try{const a=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),o=decodeURIComponent(atob(a).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(o)}catch(e){return console.error("JWT 디코딩 실패:",e),null}};return R(async()=>{try{const t=new URLSearchParams(window.location.search),e=t.get("accessToken"),a=t.get("refreshToken"),o=t.get("redirect"),n=sessionStorage.getItem("postLoginRedirect");if(!e||!a)throw new Error("토큰을 받지 못했습니다.");sessionStorage.setItem("accessToken",e),sessionStorage.setItem("refreshToken",a);const{getCurrentUser:h}=await I(async()=>{const{getCurrentUser:r}=await import("./index-B9EiY-js.js").then(u=>u.aj);return{getCurrentUser:r}},__vite__mapDeps([0,1])),d=await h();if(d.ok&&d.data)_(d.data);else{const r=v(e);if(r){const u={email:r.sub,role:r.authorities?.[0]?.replace("ROLE_","")||"USER",userId:r.userId||r.id||null};_(u)}}const f=(o&&o.startsWith("/")?o:"")||(n&&n.startsWith("/")?n:"")||"/";sessionStorage.removeItem("postLoginRedirect"),setTimeout(()=>{p.push(f)},1e3)}catch(t){console.error("OAuth2 로그인 처리 중 오류:",t),l.value=t.message||"소셜 로그인에 실패했습니다.",setTimeout(()=>{sessionStorage.removeItem("postLoginRedirect"),p.push("/login")},3e3)}finally{g.value=!1}}),(t,e)=>(c(),i("div",S,[s("div",w,[g.value?(c(),i("div",U,[...e[0]||(e[0]=[s("div",{class:"spinner"},null,-1),s("h2",null,"로그인 처리 중...",-1),s("p",null,"잠시만 기다려주세요",-1)])])):l.value?(c(),i("div",b,[e[1]||(e[1]=s("div",{class:"error-icon"},"✕",-1)),e[2]||(e[2]=s("h2",null,"로그인 실패",-1)),s("p",null,y(l.value),1),e[3]||(e[3]=s("p",{class:"redirect-info"},"로그인 페이지로 이동합니다...",-1))])):(c(),i("div",E,[...e[4]||(e[4]=[s("div",{class:"success-icon"},"✓",-1),s("h2",null,"로그인 성공!",-1),s("p",null,"메인 페이지로 이동합니다...",-1)])]))])]))}},A=k(L,[["__scopeId","data-v-a603029b"]]);export{A as default};
