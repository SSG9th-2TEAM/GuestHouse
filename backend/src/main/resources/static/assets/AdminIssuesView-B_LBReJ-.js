import{_ as $,r as _,b as S,c as i,e as t,d,F as g,f as y,t as a,m as r,H as p,l as C,k as V,o}from"./index-BGbAi4wu.js";import{A as F}from"./AdminStatCard-B-hpi9uz.js";import{A as u}from"./AdminBadge-DZBqGkqb.js";import{A as E}from"./AdminTableCard-Wxxa3FPK.js";import{b as L}from"./adminApi-1JcM-UAn.js";const T={class:"admin-page"},B={class:"admin-grid"},M={key:0,class:"admin-status"},P={key:1,class:"admin-status"},U={class:"admin-grid admin-grid--2"},H={class:"admin-table--nowrap admin-table--tight"},O={class:"admin-strong"},W={class:"admin-strong"},G={key:0,class:"admin-status"},J={class:"admin-table--tight admin-issue-table admin-issue-table--reports admin-issue-table--center"},K={class:"admin-strong"},j=["title"],q={class:"admin-issue-cell--center"},z={class:"admin-issue-reason"},Q=["title"],X=["title"],Y=["title"],Z={class:"admin-issue-cell--center"},tt={class:"admin-issue-cell--center"},st={key:0,class:"admin-issue-empty"},et={class:"admin-grid admin-grid--2"},nt={class:"admin-card"},at={class:"admin-card__head"},ot={class:"admin-card__title"},lt={class:"admin-card__meta"},it={class:"admin-card__desc"},dt={class:"admin-card"},rt={class:"admin-card__head"},ut={class:"admin-card__title"},ct={class:"admin-card__meta"},mt={class:"admin-card__desc"},_t={__name:"AdminIssuesView",setup(pt){const x=V(),A=_([]),l=_({pendingAccommodations:0,openReports:0,refundCount:0,paymentFailureCount:0,pendingAccommodationsList:[],openReportsList:[]}),v=_(!1),c=_(""),k=n=>n.toISOString().slice(0,10),b=async()=>{v.value=!0,c.value="";const n=new Date,e={from:k(n),to:k(n)},s=await L(e);s.ok&&s.data?(l.value=s.data,A.value=[{label:"승인 대기 숙소",value:`${s.data.pendingAccommodations??0}건`,sub:"심사 대기",tone:"warning"},{label:"미처리 신고",value:`${s.data.openReports??0}건`,sub:"처리 필요",tone:"warning"},{label:"결제 실패",value:`${s.data.paymentFailureCount??0}건`,sub:"실패/취소",tone:"neutral"},{label:"환불 요청",value:`${s.data.refundCount??0}건`,sub:"요청/완료",tone:"accent"}]):c.value="이슈 센터 데이터를 불러오지 못했습니다.",v.value=!1},D=n=>n==="PENDING"?"warning":n==="APPROVED"?"success":n==="REJECTED"?"danger":"neutral",R=n=>n==="WAIT"?"warning":n==="CHECKED"?"success":"neutral",I=n=>{const e=String(n?.type??"").toUpperCase();return e.includes("REVIEW")?"리뷰":e.includes("ACCOM")?"숙소":e.includes("USER")?"회원":e.includes("RESERV")?"예약":"기타"},w=n=>n?.title??"-",h=n=>n?.content??n?.description??n?.detail??n?.message??"",N=n=>{if(!n)return"-";const e=new Date(n);if(Number.isNaN(e.getTime()))return"-";const s=Date.now()-e.getTime(),f=Math.floor(s/(1e3*60*60));return f<24?`${f}h`:`${Math.floor(f/24)}일`},m=n=>{n&&x.push(n)};return S(b),(n,e)=>(o(),i("section",T,[t("header",{class:"admin-page__header"},[e[4]||(e[4]=t("div",null,[t("h1",{class:"admin-title"},"운영 이슈 센터"),t("p",{class:"admin-subtitle"},"오늘 확인해야 할 운영 이슈를 빠르게 점검합니다.")],-1)),t("button",{class:"admin-btn admin-btn--ghost",type:"button",onClick:b},"새로고침")]),t("div",B,[(o(!0),i(g,null,y(A.value,s=>(o(),C(F,{key:s.label,label:s.label,value:s.value,sub:s.sub,tone:s.tone},null,8,["label","value","sub","tone"]))),128)),v.value?(o(),i("div",M,"불러오는 중...")):c.value?(o(),i("div",P,[t("span",null,a(c.value),1),t("button",{class:"admin-btn admin-btn--ghost",type:"button",onClick:b},"다시 시도")])):d("",!0)]),t("div",U,[r(E,{title:"숙소 승인 대기"},{actions:p(()=>[t("button",{class:"admin-btn admin-btn--ghost",type:"button",onClick:e[0]||(e[0]=s=>m("/admin/accommodations?status=PENDING"))}," 바로가기 ")]),default:p(()=>[t("table",H,[e[5]||(e[5]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"숙소명"),t("th",null,"호스트"),t("th",null,"신청일"),t("th",null,"상태")])],-1)),t("tbody",null,[(o(!0),i(g,null,y(l.value.pendingAccommodationsList,s=>(o(),i("tr",{key:s.accommodationsId},[t("td",O,"#"+a(s.accommodationsId),1),t("td",W,a(s.name),1),t("td",null,a(s.hostUserId),1),t("td",null,a(s.createdAt?.slice?.(0,10)??"-"),1),t("td",null,[r(u,{text:s.approvalStatus,variant:D(s.approvalStatus)},null,8,["text","variant"])])]))),128))])]),l.value.pendingAccommodationsList?.length?d("",!0):(o(),i("div",G,"승인 대기 숙소가 없습니다."))]),_:1}),r(E,{title:"미처리 신고"},{actions:p(()=>[t("button",{class:"admin-btn admin-btn--ghost",type:"button",onClick:e[1]||(e[1]=s=>m("/admin/reports?status=WAIT"))}," 바로가기 ")]),default:p(()=>[t("table",J,[e[6]||(e[6]=t("colgroup",null,[t("col",{style:{width:"90px"}}),t("col",{style:{width:"140px"}}),t("col",{class:"admin-issue-col--reason"}),t("col",{style:{width:"110px"}}),t("col",{style:{width:"70px"}}),t("col",{style:{width:"90px"}})],-1)),e[7]||(e[7]=t("thead",null,[t("tr",null,[t("th",null,"신고ID"),t("th",null,"대상"),t("th",null,"사유/내용"),t("th",null,"등록일"),t("th",null,"경과"),t("th",null,"상태")])],-1)),t("tbody",null,[(o(!0),i(g,null,y(l.value.openReportsList?.slice(0,2),s=>(o(),i("tr",{key:s.reportId},[t("td",K,a(s.reportId?`#${s.reportId}`:"-"),1),t("td",{class:"admin-issue-cell--center",title:I(s)},a(I(s)),9,j),t("td",q,[t("div",z,[t("span",{class:"admin-issue-reason__text admin-issue-reason__title",title:w(s)},a(w(s)),9,Q),h(s)?(o(),i("span",{key:0,class:"admin-issue-reason__text admin-issue-reason__detail",title:h(s)},a(h(s)),9,X)):d("",!0)])]),t("td",{class:"admin-issue-cell--center",title:s.createdAt?.slice?.(0,10)??"-"},a(s.createdAt?.slice?.(0,10)??"-"),9,Y),t("td",Z,a(N(s.createdAt)),1),t("td",tt,[r(u,{text:s.status,variant:R(s.status)},null,8,["text","variant"])])]))),128))])]),l.value.openReportsList?.length?d("",!0):(o(),i("div",st,[r(u,{text:"정상",variant:"success"}),e[8]||(e[8]=t("span",null,"기간 내 신규 없음",-1))]))]),_:1})]),t("div",et,[t("div",nt,[t("div",at,[t("div",null,[e[9]||(e[9]=t("p",{class:"admin-card__eyebrow"},"결제 실패/취소",-1)),t("h3",ot,a(l.value.paymentFailureCount??0)+"건",1)]),t("button",{class:"admin-btn admin-btn--ghost",type:"button",onClick:e[2]||(e[2]=s=>m("/admin/payments?status=FAILED"))}," 바로가기 ")]),t("div",lt,[(l.value.paymentFailureCount??0)===0?(o(),C(u,{key:0,text:"정상",variant:"success"})):d("",!0),t("p",it,a((l.value.paymentFailureCount??0)===0?"기간 내 신규 없음":"최근 결제 실패/취소 건을 빠르게 확인하세요."),1)])]),t("div",dt,[t("div",rt,[t("div",null,[e[10]||(e[10]=t("p",{class:"admin-card__eyebrow"},"환불 요청/완료",-1)),t("h3",ut,a(l.value.refundCount??0)+"건",1)]),t("button",{class:"admin-btn admin-btn--ghost",type:"button",onClick:e[3]||(e[3]=s=>m("/admin/payments?status=REFUNDED"))}," 바로가기 ")]),t("div",ct,[(l.value.refundCount??0)===0?(o(),C(u,{key:0,text:"정상",variant:"success"})):d("",!0),t("p",mt,a((l.value.refundCount??0)===0?"기간 내 신규 없음":"환불 진행 내역을 확인할 수 있습니다."),1)])])])]))}},yt=$(_t,[["__scopeId","data-v-4ea5a8d3"]]);export{yt as default};
